{"version":3,"sources":["ComponentWrapper.js"],"names":["Object","defineProperty","exports","value","React","require","_","react_lifecycles_compat_1","hoistNonReactStatics","ComponentWrapper","componentName","OriginalComponentGenerator","store","componentEventsObserver","concreteComponentProvider","ReduxProvider","reduxStore","GeneratedComponentClass","WrappedComponent","nextProps","prevState","allProps","merge","getPropsForId","componentId","props","_assertComponentId","state","cleanId","unmounted","Error","Component","polyfill","wrapWithRedux","ReduxWrapper"],"mappings":"AAAA;;;;;;;;;;;;;;;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;;AACA,IAAMC,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,IAAMC,CAAC,GAAGD,OAAO,CAAC,QAAD,CAAjB;;AACA,IAAME,yBAAyB,GAAGF,OAAO,CAAC,yBAAD,CAAzC;;AACA,IAAMG,oBAAoB,GAAGH,OAAO,CAAC,yBAAD,CAApC;;IACMI,gB;;;;;;;yBACGC,a,EAAeC,0B,EAA4BC,K,EAAOC,uB,EAA4G;AAAA,UAAnFC,yBAAmF,uEAAvDH,0BAAuD;AAAA,UAA3BI,aAA2B;AAAA,UAAZC,UAAY;AAC/J,UAAMC,uBAAuB,GAAGN,0BAA0B,EAA1D;;AAD+J,UAEzJO,gBAFyJ;AAAA;AAAA;AAAA;AAAA,mDAG3HC,SAH2H,EAGhHC,SAHgH,EAGrG;AAClD,mBAAO;AACHC,cAAAA,QAAQ,EAAEf,CAAC,CAACgB,KAAF,CAAQ,EAAR,EAAYH,SAAZ,EAAuBP,KAAK,CAACW,aAAN,CAAoBH,SAAS,CAACI,WAA9B,CAAvB;AADP,aAAP;AAGH;AAP0J;;AAQ3J,kCAAYC,KAAZ,EAAmB;AAAA;;AAAA;AACf,4HAAMA,KAAN;;AACA,gBAAKC,kBAAL;;AACA,gBAAKC,KAAL,GAAa;AACTH,YAAAA,WAAW,EAAEC,KAAK,CAACD,WADV;AAETH,YAAAA,QAAQ,EAAE;AAFD,WAAb;AAHe;AAOlB;;AAf0J;AAAA;AAAA,iDAgBpI;AACnBT,YAAAA,KAAK,CAACgB,OAAN,CAAc,KAAKD,KAAL,CAAWH,WAAzB;AACAX,YAAAA,uBAAuB,CAACgB,SAAxB,CAAkC,KAAKF,KAAL,CAAWH,WAA7C;AACH;AAnB0J;AAAA;AAAA,mCAoBlJ;AACL,mBAAQ,oBAAC,uBAAD,6BAA6B,KAAKG,KAAL,CAAWN,QAAxC;AAAkD,cAAA,WAAW,EAAE,KAAKM,KAAL,CAAWH;AAA1E,eAAR;AACH;AAtB0J;AAAA;AAAA,+CAuBtI;AACjB,gBAAI,CAAC,KAAKC,KAAL,CAAWD,WAAhB,EAA6B;AACzB,oBAAM,IAAIM,KAAJ,gBAAuBpB,aAAvB,mCAAN;AACH;AACJ;AA3B0J;AAAA;AAAA,QAEhIN,KAAK,CAAC2B,SAF0H;;AA6B/JxB,MAAAA,yBAAyB,CAACyB,QAA1B,CAAmCd,gBAAnC;AACAV,MAAAA,oBAAoB,CAACU,gBAAD,EAAmBJ,yBAAyB,EAA5C,CAApB;AACA,aAAOC,aAAa,GAAG,KAAKkB,aAAL,CAAmBf,gBAAnB,EAAqCH,aAArC,EAAoDC,UAApD,CAAH,GAAqEE,gBAAzF;AACH;;;kCACaA,gB,EAAkBH,a,EAAeC,U,EAAY;AAAA,UACjDkB,YADiD;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mCAE1C;AACL,mBAAQ,oBAAC,aAAD;AAAe,cAAA,KAAK,EAAElB;AAAtB,eACZ,oBAAC,gBAAD,EAAsB,KAAKS,KAA3B,CADY,CAAR;AAGH;AANkD;AAAA;AAAA,QAC5BrB,KAAK,CAAC2B,SADsB;;AAQvDvB,MAAAA,oBAAoB,CAAC0B,YAAD,EAAehB,gBAAf,CAApB;AACA,aAAOgB,YAAP;AACH;;;;;AAELhC,OAAO,CAACO,gBAAR,GAA2BA,gBAA3B","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = require(\"react\");\nconst _ = require(\"lodash\");\nconst react_lifecycles_compat_1 = require(\"react-lifecycles-compat\");\nconst hoistNonReactStatics = require(\"hoist-non-react-statics\");\nclass ComponentWrapper {\n    wrap(componentName, OriginalComponentGenerator, store, componentEventsObserver, concreteComponentProvider = OriginalComponentGenerator, ReduxProvider, reduxStore) {\n        const GeneratedComponentClass = OriginalComponentGenerator();\n        class WrappedComponent extends React.Component {\n            static getDerivedStateFromProps(nextProps, prevState) {\n                return {\n                    allProps: _.merge({}, nextProps, store.getPropsForId(prevState.componentId))\n                };\n            }\n            constructor(props) {\n                super(props);\n                this._assertComponentId();\n                this.state = {\n                    componentId: props.componentId,\n                    allProps: {}\n                };\n            }\n            componentWillUnmount() {\n                store.cleanId(this.state.componentId);\n                componentEventsObserver.unmounted(this.state.componentId);\n            }\n            render() {\n                return (<GeneratedComponentClass {...this.state.allProps} componentId={this.state.componentId}/>);\n            }\n            _assertComponentId() {\n                if (!this.props.componentId) {\n                    throw new Error(`Component ${componentName} does not have a componentId!`);\n                }\n            }\n        }\n        react_lifecycles_compat_1.polyfill(WrappedComponent);\n        hoistNonReactStatics(WrappedComponent, concreteComponentProvider());\n        return ReduxProvider ? this.wrapWithRedux(WrappedComponent, ReduxProvider, reduxStore) : WrappedComponent;\n    }\n    wrapWithRedux(WrappedComponent, ReduxProvider, reduxStore) {\n        class ReduxWrapper extends React.Component {\n            render() {\n                return (<ReduxProvider store={reduxStore}>\n            <WrappedComponent {...this.props}/>\n          </ReduxProvider>);\n            }\n        }\n        hoistNonReactStatics(ReduxWrapper, WrappedComponent);\n        return ReduxWrapper;\n    }\n}\nexports.ComponentWrapper = ComponentWrapper;\n"]}