{"version":3,"sources":["ComponentEventsObserver.js"],"names":["Object","defineProperty","exports","value","_","require","ComponentEventsObserver","nativeEventsReceiver","store","listeners","alreadyRegistered","notifyComponentDidAppear","bind","notifyComponentDidDisappear","notifyNavigationButtonPressed","notifyModalDismissed","notifySearchBarUpdated","notifySearchBarCancelPressed","notifyPreviewCompleted","registerComponentDidAppearListener","registerComponentDidDisappearListener","registerNavigationButtonPressedListener","registerModalDismissedListener","registerSearchBarUpdatedListener","registerSearchBarCancelPressedListener","registerPreviewCompletedListener","component","componentId","computedComponentId","props","isString","Error","isNil","key","uniqueId","remove","unset","event","passProps","getPropsForId","triggerOnAllListenersByComponentId","method","forEach"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst _ = require(\"lodash\");\nclass ComponentEventsObserver {\n    constructor(nativeEventsReceiver, store) {\n        this.nativeEventsReceiver = nativeEventsReceiver;\n        this.store = store;\n        this.listeners = {};\n        this.alreadyRegistered = false;\n        this.notifyComponentDidAppear = this.notifyComponentDidAppear.bind(this);\n        this.notifyComponentDidDisappear = this.notifyComponentDidDisappear.bind(this);\n        this.notifyNavigationButtonPressed = this.notifyNavigationButtonPressed.bind(this);\n        this.notifyModalDismissed = this.notifyModalDismissed.bind(this);\n        this.notifySearchBarUpdated = this.notifySearchBarUpdated.bind(this);\n        this.notifySearchBarCancelPressed = this.notifySearchBarCancelPressed.bind(this);\n        this.notifyPreviewCompleted = this.notifyPreviewCompleted.bind(this);\n    }\n    registerOnceForAllComponentEvents() {\n        if (this.alreadyRegistered) {\n            return;\n        }\n        this.alreadyRegistered = true;\n        this.nativeEventsReceiver.registerComponentDidAppearListener(this.notifyComponentDidAppear);\n        this.nativeEventsReceiver.registerComponentDidDisappearListener(this.notifyComponentDidDisappear);\n        this.nativeEventsReceiver.registerNavigationButtonPressedListener(this.notifyNavigationButtonPressed);\n        this.nativeEventsReceiver.registerModalDismissedListener(this.notifyModalDismissed);\n        this.nativeEventsReceiver.registerSearchBarUpdatedListener(this.notifySearchBarUpdated);\n        this.nativeEventsReceiver.registerSearchBarCancelPressedListener(this.notifySearchBarCancelPressed);\n        this.nativeEventsReceiver.registerPreviewCompletedListener(this.notifyPreviewCompleted);\n    }\n    bindComponent(component, componentId) {\n        const computedComponentId = componentId || component.props.componentId;\n        if (!_.isString(computedComponentId)) {\n            throw new Error(`bindComponent expects a component with a componentId in props or a componentId as the second argument`);\n        }\n        if (_.isNil(this.listeners[computedComponentId])) {\n            this.listeners[computedComponentId] = {};\n        }\n        const key = _.uniqueId();\n        this.listeners[computedComponentId][key] = component;\n        return { remove: () => _.unset(this.listeners[computedComponentId], key) };\n    }\n    unmounted(componentId) {\n        _.unset(this.listeners, componentId);\n    }\n    notifyComponentDidAppear(event) {\n        event.passProps = this.store.getPropsForId(event.componentId);\n        this.triggerOnAllListenersByComponentId(event, 'componentDidAppear');\n    }\n    notifyComponentDidDisappear(event) {\n        this.triggerOnAllListenersByComponentId(event, 'componentDidDisappear');\n    }\n    notifyNavigationButtonPressed(event) {\n        this.triggerOnAllListenersByComponentId(event, 'navigationButtonPressed');\n    }\n    notifyModalDismissed(event) {\n        this.triggerOnAllListenersByComponentId(event, 'modalDismissed');\n    }\n    notifySearchBarUpdated(event) {\n        this.triggerOnAllListenersByComponentId(event, 'searchBarUpdated');\n    }\n    notifySearchBarCancelPressed(event) {\n        this.triggerOnAllListenersByComponentId(event, 'searchBarCancelPressed');\n    }\n    notifyPreviewCompleted(event) {\n        this.triggerOnAllListenersByComponentId(event, 'previewCompleted');\n    }\n    triggerOnAllListenersByComponentId(event, method) {\n        _.forEach(this.listeners[event.componentId], (component) => {\n            if (component && component[method]) {\n                component[method](event);\n            }\n        });\n    }\n}\nexports.ComponentEventsObserver = ComponentEventsObserver;\n"]}