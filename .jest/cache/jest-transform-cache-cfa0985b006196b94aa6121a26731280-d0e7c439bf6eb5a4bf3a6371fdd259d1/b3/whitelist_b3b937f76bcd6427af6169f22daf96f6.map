{"version":3,"sources":["whitelist.js"],"names":["ParameterError","expected","actual","missing","JSON","stringify","BaseError","apply","rules","values","whitelist","parameters","aliases","mapped","requiredKeys","Object","keys","filter","key","required","map","toName","value","parameterKey","parameter","length"],"mappings":";;;;;;;;;;;;;;;;AAAA;;IAEqBA,c;;;AACnB,0BAAYC,QAAZ,EAAsBC,MAAtB,EAA8BC,OAA9B,EAAuC;AAAA;;AAAA;AACrC,oHACE,6BADF,oCAEkCC,IAAI,CAACC,SAAL,CAAeF,OAAf,EAAwB,IAAxB,EAA8B,CAA9B,CAFlC;AAIA,UAAKF,QAAL,GAAgBA,QAAhB;AACA,UAAKC,MAAL,GAAcA,MAAd;AACA,UAAKC,OAAL,GAAeA,OAAf;AAPqC;AAQtC;;;EATyCG,kB;;;;AAYrC,SAASC,KAAT,CAAeC,KAAf,EAAsBC,MAAtB,EAA8B;AAAA,yBACoBD,KADpB,CAC3BE,SAD2B;AAAA,MAC3BA,SAD2B,iCACf,IADe;AAAA,MACTC,UADS,GACoBH,KADpB,CACTG,UADS;AAAA,uBACoBH,KADpB,CACGI,OADH;AAAA,MACGA,OADH,+BACa,EADb;AAEnC,MAAIC,MAAM,GAAG,EAAb;AACA,MAAIC,YAAY,GAAGC,MAAM,CAACC,IAAP,CAAYL,UAAZ,EAChBM,MADgB,CACT,UAAAC,GAAG;AAAA,WAAIP,UAAU,CAACO,GAAD,CAAV,CAAgBC,QAApB;AAAA,GADM,EAEhBC,GAFgB,CAEZ,UAAAF,GAAG;AAAA,WAAIP,UAAU,CAACO,GAAD,CAAV,CAAgBG,MAAhB,IAA0BH,GAA9B;AAAA,GAFS,CAAnB;;AAGA,kCAAgBH,MAAM,CAACC,IAAP,CAAYP,MAAZ,CAAhB,kCAAqC;AAAhC,QAAIS,GAAG,mBAAP;AACH,QAAII,KAAK,GAAGb,MAAM,CAACS,GAAD,CAAlB;AACA,QAAIK,YAAY,GAAGX,OAAO,CAACM,GAAD,CAAP,IAAgBA,GAAnC;AACA,QAAIM,SAAS,GAAGb,UAAU,CAACY,YAAD,CAA1B;;AACA,QAAIC,SAAS,IAAIF,KAAjB,EAAwB;AACtBT,MAAAA,MAAM,CAACW,SAAS,CAACH,MAAV,IAAoBE,YAArB,CAAN,GAA2CD,KAA3C;AACD,KAFD,MAEO,IAAIA,KAAK,IAAI,CAACZ,SAAd,EAAyB;AAC9BG,MAAAA,MAAM,CAACK,GAAD,CAAN,GAAcI,KAAd;AACD;AACF;;AACD,MAAInB,OAAO,GAAGW,YAAY,CAACG,MAAb,CAAoB,UAAAC,GAAG;AAAA,WAAI,CAACL,MAAM,CAACK,GAAD,CAAX;AAAA,GAAvB,CAAd;;AACA,MAAIf,OAAO,CAACsB,MAAR,GAAiB,CAArB,EAAwB;AACtB,UAAM,IAAIzB,cAAJ,CAAmBc,YAAnB,EAAiCL,MAAjC,EAAyCN,OAAzC,CAAN;AACD;;AACD,SAAOU,MAAP;AACD","sourcesContent":["import BaseError from './baseError';\n\nexport default class ParameterError extends BaseError {\n  constructor(expected, actual, missing) {\n    super(\n      'Missing required parameters',\n      `Missing required parameters: ${JSON.stringify(missing, null, 2)}`\n    );\n    this.expected = expected;\n    this.actual = actual;\n    this.missing = missing;\n  }\n}\n\nexport function apply(rules, values) {\n  const { whitelist = true, parameters, aliases = {} } = rules;\n  let mapped = {};\n  let requiredKeys = Object.keys(parameters)\n    .filter(key => parameters[key].required)\n    .map(key => parameters[key].toName || key);\n  for (let key of Object.keys(values)) {\n    let value = values[key];\n    let parameterKey = aliases[key] || key;\n    let parameter = parameters[parameterKey];\n    if (parameter && value) {\n      mapped[parameter.toName || parameterKey] = value;\n    } else if (value && !whitelist) {\n      mapped[key] = value;\n    }\n  }\n  let missing = requiredKeys.filter(key => !mapped[key]);\n  if (missing.length > 0) {\n    throw new ParameterError(requiredKeys, values, missing);\n  }\n  return mapped;\n}\n"]}