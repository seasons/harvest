ff3c3cc01349889b45fc66fbdca9b9e5
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var EventEmitter = require('EventEmitter');

var EventEmitterWithHolding = require('EventEmitterWithHolding');

var EventHolder = require('EventHolder');

var invariant = require('invariant');

var keyOf = require('fbjs/lib/keyOf');

var TYPES_KEY = keyOf({
  __types: true
});

function mixInEventEmitter(cls, types) {
  invariant(types, 'Must supply set of valid event types');
  var target = cls.prototype || cls;
  invariant(!target.__eventEmitter, 'An active emitter is already mixed in');
  var ctor = cls.constructor;

  if (ctor) {
    invariant(ctor === Object || ctor === Function, 'Mix EventEmitter into a class, not an instance');
  }

  if (target.hasOwnProperty(TYPES_KEY)) {
    (0, _extends2.default)(target.__types, types);
  } else if (target.__types) {
    target.__types = (0, _extends2.default)({}, target.__types, types);
  } else {
    target.__types = types;
  }

  (0, _extends2.default)(target, EventEmitterMixin);
}

var EventEmitterMixin = {
  emit: function emit(eventType, a, b, c, d, e, _) {
    return this.__getEventEmitter().emit(eventType, a, b, c, d, e, _);
  },
  emitAndHold: function emitAndHold(eventType, a, b, c, d, e, _) {
    return this.__getEventEmitter().emitAndHold(eventType, a, b, c, d, e, _);
  },
  addListener: function addListener(eventType, listener, context) {
    return this.__getEventEmitter().addListener(eventType, listener, context);
  },
  once: function once(eventType, listener, context) {
    return this.__getEventEmitter().once(eventType, listener, context);
  },
  addRetroactiveListener: function addRetroactiveListener(eventType, listener, context) {
    return this.__getEventEmitter().addRetroactiveListener(eventType, listener, context);
  },
  addListenerMap: function addListenerMap(listenerMap, context) {
    return this.__getEventEmitter().addListenerMap(listenerMap, context);
  },
  addRetroactiveListenerMap: function addRetroactiveListenerMap(listenerMap, context) {
    return this.__getEventEmitter().addListenerMap(listenerMap, context);
  },
  removeAllListeners: function removeAllListeners() {
    this.__getEventEmitter().removeAllListeners();
  },
  removeCurrentListener: function removeCurrentListener() {
    this.__getEventEmitter().removeCurrentListener();
  },
  releaseHeldEventType: function releaseHeldEventType(eventType) {
    this.__getEventEmitter().releaseHeldEventType(eventType);
  },
  __getEventEmitter: function __getEventEmitter() {
    if (!this.__eventEmitter) {
      var emitter = new EventEmitter();

      if (__DEV__) {
        var EventValidator = require('EventValidator');

        emitter = EventValidator.addValidation(emitter, this.__types);
      }

      var holder = new EventHolder();
      this.__eventEmitter = new EventEmitterWithHolding(emitter, holder);
    }

    return this.__eventEmitter;
  }
};
module.exports = mixInEventEmitter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1peEluRXZlbnRFbWl0dGVyLmpzIl0sIm5hbWVzIjpbIkV2ZW50RW1pdHRlciIsInJlcXVpcmUiLCJFdmVudEVtaXR0ZXJXaXRoSG9sZGluZyIsIkV2ZW50SG9sZGVyIiwiaW52YXJpYW50Iiwia2V5T2YiLCJUWVBFU19LRVkiLCJfX3R5cGVzIiwibWl4SW5FdmVudEVtaXR0ZXIiLCJjbHMiLCJ0eXBlcyIsInRhcmdldCIsInByb3RvdHlwZSIsIl9fZXZlbnRFbWl0dGVyIiwiY3RvciIsImNvbnN0cnVjdG9yIiwiT2JqZWN0IiwiRnVuY3Rpb24iLCJoYXNPd25Qcm9wZXJ0eSIsIkV2ZW50RW1pdHRlck1peGluIiwiZW1pdCIsImV2ZW50VHlwZSIsImEiLCJiIiwiYyIsImQiLCJlIiwiXyIsIl9fZ2V0RXZlbnRFbWl0dGVyIiwiZW1pdEFuZEhvbGQiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyIiwiY29udGV4dCIsIm9uY2UiLCJhZGRSZXRyb2FjdGl2ZUxpc3RlbmVyIiwiYWRkTGlzdGVuZXJNYXAiLCJsaXN0ZW5lck1hcCIsImFkZFJldHJvYWN0aXZlTGlzdGVuZXJNYXAiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJyZW1vdmVDdXJyZW50TGlzdGVuZXIiLCJyZWxlYXNlSGVsZEV2ZW50VHlwZSIsImVtaXR0ZXIiLCJfX0RFVl9fIiwiRXZlbnRWYWxpZGF0b3IiLCJhZGRWYWxpZGF0aW9uIiwiaG9sZGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBVUE7Ozs7OztBQUVBLElBQU1BLFlBQVksR0FBR0MsT0FBTyxDQUFDLGNBQUQsQ0FBNUI7O0FBQ0EsSUFBTUMsdUJBQXVCLEdBQUdELE9BQU8sQ0FBQyx5QkFBRCxDQUF2Qzs7QUFDQSxJQUFNRSxXQUFXLEdBQUdGLE9BQU8sQ0FBQyxhQUFELENBQTNCOztBQUVBLElBQU1HLFNBQVMsR0FBR0gsT0FBTyxDQUFDLFdBQUQsQ0FBekI7O0FBSUEsSUFBTUksS0FBSyxHQUFHSixPQUFPLENBQUMs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RDtBQXpEdUIsQ0FBMUI7QUE0REFpQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJ2QyxpQkFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmb3JtYXRcbiAqIEBmbG93XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBFdmVudEVtaXR0ZXIgPSByZXF1aXJlKCdFdmVudEVtaXR0ZXInKTtcbmNvbnN0IEV2ZW50RW1pdHRlcldpdGhIb2xkaW5nID0gcmVxdWlyZSgnRXZlbnRFbWl0dGVyV2l0aEhvbGRpbmcnKTtcbmNvbnN0IEV2ZW50SG9sZGVyID0gcmVxdWlyZSgnRXZlbnRIb2xkZXInKTtcblxuY29uc3QgaW52YXJpYW50ID0gcmVxdWlyZSgnaW52YXJpYW50Jyk7XG4vKiAkRmxvd0ZpeE1lKD49MC41NC4wIHNpdGU9cmVhY3RfbmF0aXZlX29zcykgVGhpcyBjb21tZW50IHN1cHByZXNzZXMgYW4gZXJyb3JcbiAqIGZvdW5kIHdoZW4gRmxvdyB2MC41NCB3YXMgZGVwbG95ZWQuIFRvIHNlZSB0aGUgZXJyb3IgZGVsZXRlIHRoaXMgY29tbWVudCBhbmRcbiAqIHJ1biBGbG93LiAqL1xuY29uc3Qga2V5T2YgPSByZXF1aXJlKCdmYmpzL2xpYi9rZXlPZicpO1xuXG5pbXBvcnQgdHlwZSBFbWl0dGVyU3Vic2NyaXB0aW9uIGZyb20gJ0VtaXR0ZXJTdWJzY3JpcHRpb24nO1xuXG5jb25zdCBUWVBFU19LRVkgPSBrZXlPZih7X190eXBlczogdHJ1ZX0pO1xuXG4vKipcbiAqIEFQSSB0byBzZXR1cCBhbiBvYmplY3Qgb3IgY29uc3RydWN0b3IgdG8gYmUgYWJsZSB0byBlbWl0IGRhdGEgZXZlbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBmdW5jdGlvbiBEb2coKSB7IC4uLmRvZyBzdHVmZi4uLiB9XG4gKiBtaXhJbkV2ZW50RW1pdHRlcihEb2csIHtiYXJrOiB0cnVlfSk7XG4gKlxuICogdmFyIHB1cHB5ID0gbmV3IERvZygpO1xuICogcHVwcHkuYWRkTGlzdGVuZXIoJ2JhcmsnLCBmdW5jdGlvbiAodm9sdW1lKSB7XG4gKiAgIGNvbnNvbGUubG9nKCdQdXBweScsIHRoaXMsICdiYXJrZWQgYXQgdm9sdW1lOicsIHZvbHVtZSk7XG4gKiB9KTtcbiAqIHB1cHB5LmVtaXQoJ2JhcmsnLCAncXVpZXQnKTtcbiAqIC8vIFB1cHB5IDxwdXBweT4gYmFya2VkIGF0IHZvbHVtZTogcXVpZXRcbiAqXG4gKlxuICogLy8gQSBcInNpbmdsZXRvblwiIG9iamVjdCBtYXkgYWxzbyBiZSBjb21taXNzaW9uZWQ6XG4gKlxuICogdmFyIFNpbmdsZXRvbiA9IHt9O1xuICogbWl4SW5FdmVudEVtaXR0ZXIoU2luZ2xldG9uLCB7bG9uZWx5OiB0cnVlfSk7XG4gKiBTaW5nbGV0b24uZW1pdCgnbG9uZWx5JywgdHJ1ZSk7XG4gKi9cbmZ1bmN0aW9uIG1peEluRXZlbnRFbWl0dGVyKGNsczogRnVuY3Rpb24gfCBPYmplY3QsIHR5cGVzOiBPYmplY3QpIHtcbiAgaW52YXJpYW50KHR5cGVzLCAnTXVzdCBzdXBwbHkgc2V0IG9mIHZhbGlkIGV2ZW50IHR5cGVzJyk7XG5cbiAgLy8gSWYgdGhpcyBpcyBhIGNvbnN0cnVjdG9yLCB3cml0ZSB0byB0aGUgcHJvdG90eXBlLCBvdGhlcndpc2Ugd3JpdGUgdG8gdGhlXG4gIC8vIHNpbmdsZXRvbiBvYmplY3QuXG4gIGNvbnN0IHRhcmdldCA9IGNscy5wcm90b3R5cGUgfHwgY2xzO1xuXG4gIGludmFyaWFudCghdGFyZ2V0Ll9fZXZlbnRFbWl0dGVyLCAnQW4gYWN0aXZlIGVtaXR0ZXIgaXMgYWxyZWFkeSBtaXhlZCBpbicpO1xuXG4gIGNvbnN0IGN0b3IgPSBjbHMuY29uc3RydWN0b3I7XG4gIGlmIChjdG9yKSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgY3RvciA9PT0gT2JqZWN0IHx8IGN0b3IgPT09IEZ1bmN0aW9uLFxuICAgICAgJ01peCBFdmVudEVtaXR0ZXIgaW50byBhIGNsYXNzLCBub3QgYW4gaW5zdGFuY2UnLFxuICAgICk7XG4gIH1cblxuICAvLyBLZWVwIHRyYWNrIG9mIHRoZSBwcm92aWRlZCB0eXBlcywgdW5pb24gdGhlIHR5cGVzIGlmIHRoZXkgYWxyZWFkeSBleGlzdCxcbiAgLy8gd2hpY2ggYWxsb3dzIGZvciBwcm90b3R5cGUgc3ViY2xhc3NlcyB0byBwcm92aWRlIG1vcmUgdHlwZXMuXG4gIGlmICh0YXJnZXQuaGFzT3duUHJvcGVydHkoVFlQRVNfS0VZKSkge1xuICAgIE9iamVjdC5hc3NpZ24odGFyZ2V0Ll9fdHlwZXMsIHR5cGVzKTtcbiAgfSBlbHNlIGlmICh0YXJnZXQuX190eXBlcykge1xuICAgIHRhcmdldC5fX3R5cGVzID0gT2JqZWN0LmFzc2lnbih7fSwgdGFyZ2V0Ll9fdHlwZXMsIHR5cGVzKTtcbiAgfSBlbHNlIHtcbiAgICB0YXJnZXQuX190eXBlcyA9IHR5cGVzO1xuICB9XG4gIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBFdmVudEVtaXR0ZXJNaXhpbik7XG59XG5cbmNvbnN0IEV2ZW50RW1pdHRlck1peGluID0ge1xuICBlbWl0OiBmdW5jdGlvbihldmVudFR5cGUsIGEsIGIsIGMsIGQsIGUsIF8pIHtcbiAgICByZXR1cm4gdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLmVtaXQoZXZlbnRUeXBlLCBhLCBiLCBjLCBkLCBlLCBfKTtcbiAgfSxcblxuICBlbWl0QW5kSG9sZDogZnVuY3Rpb24oZXZlbnRUeXBlLCBhLCBiLCBjLCBkLCBlLCBfKSB7XG4gICAgcmV0dXJuIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5lbWl0QW5kSG9sZChldmVudFR5cGUsIGEsIGIsIGMsIGQsIGUsIF8pO1xuICB9LFxuXG4gIGFkZExpc3RlbmVyOiBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyLCBjb250ZXh0KTogRW1pdHRlclN1YnNjcmlwdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5hZGRMaXN0ZW5lcihldmVudFR5cGUsIGxpc3RlbmVyLCBjb250ZXh0KTtcbiAgfSxcblxuICBvbmNlOiBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyLCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5vbmNlKGV2ZW50VHlwZSwgbGlzdGVuZXIsIGNvbnRleHQpO1xuICB9LFxuXG4gIGFkZFJldHJvYWN0aXZlTGlzdGVuZXI6IGZ1bmN0aW9uKGV2ZW50VHlwZSwgbGlzdGVuZXIsIGNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLmFkZFJldHJvYWN0aXZlTGlzdGVuZXIoXG4gICAgICBldmVudFR5cGUsXG4gICAgICBsaXN0ZW5lcixcbiAgICAgIGNvbnRleHQsXG4gICAgKTtcbiAgfSxcblxuICBhZGRMaXN0ZW5lck1hcDogZnVuY3Rpb24obGlzdGVuZXJNYXAsIGNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLmFkZExpc3RlbmVyTWFwKGxpc3RlbmVyTWFwLCBjb250ZXh0KTtcbiAgfSxcblxuICBhZGRSZXRyb2FjdGl2ZUxpc3RlbmVyTWFwOiBmdW5jdGlvbihsaXN0ZW5lck1hcCwgY29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkuYWRkTGlzdGVuZXJNYXAobGlzdGVuZXJNYXAsIGNvbnRleHQpO1xuICB9LFxuXG4gIHJlbW92ZUFsbExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICB9LFxuXG4gIHJlbW92ZUN1cnJlbnRMaXN0ZW5lcjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLnJlbW92ZUN1cnJlbnRMaXN0ZW5lcigpO1xuICB9LFxuXG4gIHJlbGVhc2VIZWxkRXZlbnRUeXBlOiBmdW5jdGlvbihldmVudFR5cGUpIHtcbiAgICB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkucmVsZWFzZUhlbGRFdmVudFR5cGUoZXZlbnRUeXBlKTtcbiAgfSxcblxuICBfX2dldEV2ZW50RW1pdHRlcjogZnVuY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLl9fZXZlbnRFbWl0dGVyKSB7XG4gICAgICBsZXQgZW1pdHRlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgIGlmIChfX0RFVl9fKSB7XG4gICAgICAgIGNvbnN0IEV2ZW50VmFsaWRhdG9yID0gcmVxdWlyZSgnRXZlbnRWYWxpZGF0b3InKTtcbiAgICAgICAgZW1pdHRlciA9IEV2ZW50VmFsaWRhdG9yLmFkZFZhbGlkYXRpb24oZW1pdHRlciwgdGhpcy5fX3R5cGVzKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaG9sZGVyID0gbmV3IEV2ZW50SG9sZGVyKCk7XG4gICAgICB0aGlzLl9fZXZlbnRFbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcldpdGhIb2xkaW5nKGVtaXR0ZXIsIGhvbGRlcik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9fZXZlbnRFbWl0dGVyO1xuICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtaXhJbkV2ZW50RW1pdHRlcjtcbiJdfQ==