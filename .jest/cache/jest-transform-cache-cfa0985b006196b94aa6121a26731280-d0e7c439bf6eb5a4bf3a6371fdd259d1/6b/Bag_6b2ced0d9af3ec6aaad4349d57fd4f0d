656cfddbf5f6b6ba6166d9279fa66529
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Bag = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _react = _interopRequireWildcard(require("react"));

var _Container = require("../../Components/Container");

var _Typography = require("../../Components/Typography");

var _Components = require("./Components.tsx");

var _Components2 = require("../../Components");

var _reactNative = require("react-native");

var _StateProvider = require("../../helpers/StateProvider");

var _Utils = require("../../Utils");

var _svgs = require("../../../assets/svgs");

var _Navigation = require("../../Navigation");

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var SECTION_HEIGHT = 200;

var Bag = function Bag() {
  var _useStateValue = (0, _StateProvider.useStateValue)(),
      _useStateValue2 = (0, _slicedToArray2.default)(_useStateValue, 2),
      bag = _useStateValue2[0].bag,
      dispatch = _useStateValue2[1];

  var _useState = (0, _react.useState)([]),
      _useState2 = (0, _slicedToArray2.default)(_useState, 2),
      bagItems = _useState2[0],
      setBagItems = _useState2[1];

  (0, _react.useEffect)(function () {
    var bagArray = bag.items.forEach(function (item) {
      bagItems.push(_objectSpread({
        type: "item"
      }, item));
    });

    for (var i = 0; i < remainingPieces; i++) {
      bagItems.push({
        type: "empty"
      });
    }

    setBagItems(bagArray);
    console.log("bagitems????", bagItems);
  }, [bag]);

  if (!bag || !bag.items) {
    return null;
  }

  var bagIsEmpty = bag.items.length === 0;
  var remainingPieces = 3 - bag.items.length;

  var handleRemove = function handleRemove(id) {
    return id;
  };

  var handleBagPlusPress = function handleBagPlusPress() {
    return (0, _Navigation.goToBrowse)();
  };

  var emptyBagItem = function emptyBagItem(index) {
    return _react.default.createElement(_Components2.Box, {
      p: 2,
      style: {
        height: SECTION_HEIGHT
      }
    }, _react.default.createElement(_Components2.Flex, {
      style: {
        flex: 2
      },
      flexWrap: "nowrap",
      flexDirection: "column",
      justifyContent: "space-between"
    }, _react.default.createElement(_Components2.Box, null, _react.default.createElement(_Typography.Sans, {
      size: "3"
    }, index + 1, "."), _react.default.createElement(_Typography.Sans, {
      size: "2",
      color: "gray"
    }, "Add your item")), _react.default.createElement(_Components2.Flex, {
      style: {
        flex: 2
      },
      flexDirection: "row",
      justifyContent: "flex-end",
      alignItems: "center"
    }, _react.default.createElement(_reactNative.TouchableWithoutFeedback, {
      onPress: function onPress() {
        return handleBagPlusPress();
      }
    }, _react.default.createElement(_svgs.BagPlus, null)), _react.default.createElement(_Components2.Spacer, {
      mr: 3
    }))));
  };

  var bagItem = function bagItem(item, index) {
    var imageURL = item.images && item.images.length && item.images[0].url;
    return _react.default.createElement(_Components2.Box, {
      p: 2,
      key: item.id,
      style: {
        height: SECTION_HEIGHT
      }
    }, _react.default.createElement(_Components2.Flex, {
      flexDirection: "row",
      style: {
        flex: 1
      }
    }, _react.default.createElement(_Components2.Flex, {
      style: {
        flex: 2
      },
      flexWrap: "nowrap",
      flexDirection: "column",
      justifyContent: "space-between"
    }, _react.default.createElement(_Components2.Box, null, _react.default.createElement(_Typography.Sans, {
      size: "3"
    }, index + 1, "."), _react.default.createElement(_Typography.Sans, {
      size: "2"
    }, item.brand.name, "."), _react.default.createElement(_Typography.Sans, {
      size: "2",
      color: "gray"
    }, item.name, ".")), _react.default.createElement(_Components2.Box, null, _react.default.createElement(_reactNative.Text, null, _react.default.createElement(_Typography.Sans, {
      size: "2",
      color: "gray"
    }, "Size ", item.modelSize, " |"), "  ", _react.default.createElement(_reactNative.TouchableWithoutFeedback, {
      onPress: function onPress() {
        return dispatch({
          type: "removeItemFromBag",
          item: item
        });
      }
    }, _react.default.createElement(_Typography.Sans, {
      size: "2",
      color: "blue"
    }, "Remove"))))), _react.default.createElement(_Components2.Flex, {
      style: {
        flex: 2
      },
      flexDirection: "row",
      justifyContent: "flex-end",
      alignItems: "center"
    }, _react.default.createElement(_reactNative.Image, {
      style: {
        height: SECTION_HEIGHT,
        width: 160
      },
      resizeMode: "contain",
      source: {
        uri: imageURL
      }
    }))));
  };

  var _renderItem = function renderItem(_ref) {
    var item = _ref.item,
        index = _ref.index;
    return item.type === "item" ? bagItem(item, index) : emptyBagItem(index);
  };

  return _react.default.createElement(_Components2.Theme, null, _react.default.createElement(_Container.Container, null, _react.default.createElement(_Components2.Box, {
    style: {
      flex: 1
    }
  }, _react.default.createElement(_Components2.Spacer, {
    mb: 3
  }), bagIsEmpty ? _react.default.createElement(_Components2.Flex, {
    flex: 1,
    flexDirection: "column",
    justifyContent: "center",
    alignContent: "center"
  }, _react.default.createElement(_Components.EmptyState, {
    remainingPieces: remainingPieces
  })) : _react.default.createElement(_Components2.Box, null, _react.default.createElement(_Components2.Spacer, {
    mb: 3
  }), _react.default.createElement(_reactNative.FlatList, {
    data: bagItems,
    ListHeaderComponent: function ListHeaderComponent() {
      return _react.default.createElement(_Components2.Box, {
        p: 2
      }, _react.default.createElement(_Typography.Sans, {
        size: "3",
        color: "black"
      }, "My bag"), _react.default.createElement(_Typography.Sans, {
        size: "2",
        color: "gray"
      }, "You have ", remainingPieces, " pieces remaining"));
    },
    ItemSeparatorComponent: function ItemSeparatorComponent() {
      return _react.default.createElement(_Components2.Box, {
        px: 2
      }, _react.default.createElement(_Components2.Spacer, {
        mb: 2
      }), _react.default.createElement(_Components2.Separator, {
        color: (0, _Utils.color)("lightGray")
      }), _react.default.createElement(_Components2.Spacer, {
        mb: 2
      }));
    },
    keyExtractor: function keyExtractor(_item, index) {
      return String(index);
    },
    renderItem: function renderItem(item) {
      return _renderItem(item);
    },
    ListFooterComponent: function ListFooterComponent() {
      return _react.default.createElement(_Components2.Spacer, {
        mb: 200
      });
    }
  })))));
};

exports.Bag = Bag;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJhZy50c3giXSwibmFtZXMiOlsiU0VDVElPTl9IRUlHSFQiLCJCYWciLCJiYWciLCJkaXNwYXRjaCIsImJhZ0l0ZW1zIiwic2V0QmFnSXRlbXMiLCJiYWdBcnJheSIsIml0ZW1zIiwiZm9yRWFjaCIsIml0ZW0iLCJwdXNoIiwidHlwZSIsImkiLCJyZW1haW5pbmdQaWVjZXMiLCJjb25zb2xlIiwibG9nIiwiYmFnSXNFbXB0eSIsImxlbmd0aCIsImhhbmRsZVJlbW92ZSIsImlkIiwiaGFuZGxlQmFnUGx1c1ByZXNzIiwiZW1wdHlCYWdJdGVtIiwiaW5kZXgiLCJoZWlnaHQiLCJmbGV4IiwiYmFnSXRlbSIsImltYWdlVVJMIiwiaW1hZ2VzIiwidXJsIiwiYnJhbmQiLCJuYW1lIiwibW9kZWxTaXplIiwid2lkdGgiLCJ1cmkiLCJyZW5kZXJJdGVtIiwiX2l0ZW0iLCJTdHJpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7Ozs7O0FBRUEsSUFBTUEsY0FBYyxHQUFHLEdBQXZCOztBQUVPLElBQU1DLEdBQUcsR0FBRyxTQUFOQSxHQUFNLEdBQU07QUFBQSx1QkFDSyxtQ0FETDtBQUFBO0FBQUEsTUFDZEMsR0FEYyxzQkFDZEEsR0FEYztBQUFBLE1BQ1BDLFFBRE87O0FBQUEsa0JBRVMscUJBQVMsRUFBVCxDQUZUO0FBQUE7QUFBQSxNQUVoQkMsUUFGZ0I7QUFBQSxNQUVOQyxXQUZNOztBQUd2Qix3QkFBVSxZQUFNO0FBQ2QsUUFBTUMsUUFBUSxHQUFHSixHQUFHLENBQUNLLEtBQUosQ0FBVUMsT0FBVixDQUFrQixVQUFBQyxJQUFJLEVBQUk7QUFDekNMLE1BQUFBLFFBQVEsQ0FBQ00sSUFBVDtBQUFnQkMsUUFBQUEsSUFBSSxFQUFFO0FBQXRCLFNBQWlDRixJQUFqQztBQUNELEtBRmdCLENBQWpCOztBQUdBLFNBQUssSUFBSUcsQ0FBQyxHQUFHLENB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RSxJQUFBLElBQUksRUFBRVQsUUFEUjtBQUVFLElBQUEsbUJBQW1CLEVBQUU7QUFBQSxhQUNuQiw2QkFBQyxnQkFBRDtBQUFLLFFBQUEsQ0FBQyxFQUFFO0FBQVIsU0FDRSw2QkFBQyxnQkFBRDtBQUFNLFFBQUEsSUFBSSxFQUFDLEdBQVg7QUFBZSxRQUFBLEtBQUssRUFBQztBQUFyQixrQkFERixFQUlFLDZCQUFDLGdCQUFEO0FBQU0sUUFBQSxJQUFJLEVBQUMsR0FBWDtBQUFlLFFBQUEsS0FBSyxFQUFDO0FBQXJCLHNCQUNZUyxlQURaLHNCQUpGLENBRG1CO0FBQUEsS0FGdkI7QUFZRSxJQUFBLHNCQUFzQixFQUFFO0FBQUEsYUFDdEIsNkJBQUMsZ0JBQUQ7QUFBSyxRQUFBLEVBQUUsRUFBRTtBQUFULFNBQ0UsNkJBQUMsbUJBQUQ7QUFBUSxRQUFBLEVBQUUsRUFBRTtBQUFaLFFBREYsRUFFRSw2QkFBQyxzQkFBRDtBQUFXLFFBQUEsS0FBSyxFQUFFLGtCQUFNLFdBQU47QUFBbEIsUUFGRixFQUdFLDZCQUFDLG1CQUFEO0FBQVEsUUFBQSxFQUFFLEVBQUU7QUFBWixRQUhGLENBRHNCO0FBQUEsS0FaMUI7QUFtQkUsSUFBQSxZQUFZLEVBQUUsc0JBQUNzQixLQUFELEVBQVFiLEtBQVI7QUFBQSxhQUFrQmMsTUFBTSxDQUFDZCxLQUFELENBQXhCO0FBQUEsS0FuQmhCO0FBb0JFLElBQUEsVUFBVSxFQUFFLG9CQUFBYixJQUFJO0FBQUEsYUFBSXlCLFdBQVUsQ0FBQ3pCLElBQUQsQ0FBZDtBQUFBLEtBcEJsQjtBQXFCRSxJQUFBLG1CQUFtQixFQUFFO0FBQUEsYUFBTSw2QkFBQyxtQkFBRDtBQUFRLFFBQUEsRUFBRSxFQUFFO0FBQVosUUFBTjtBQUFBO0FBckJ2QixJQUZGLENBUEosQ0FERixDQURGLENBREY7QUF5Q0QsQ0F6SU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gXCJyZWFjdFwiXG5pbXBvcnQgeyBDb250YWluZXIgfSBmcm9tIFwiQ29tcG9uZW50cy9Db250YWluZXJcIlxuaW1wb3J0IHsgU2FucyB9IGZyb20gXCJDb21wb25lbnRzL1R5cG9ncmFwaHlcIlxuaW1wb3J0IHsgRW1wdHlTdGF0ZSB9IGZyb20gXCIuL0NvbXBvbmVudHMudHN4XCJcbmltcG9ydCB7IFRoZW1lLCBTcGFjZXIsIEZsZXgsIEJveCwgU2VwYXJhdG9yIH0gZnJvbSBcIkFwcC9Db21wb25lbnRzXCJcbmltcG9ydCB7IFRleHQsIEltYWdlLCBGbGF0TGlzdCB9IGZyb20gXCJyZWFjdC1uYXRpdmVcIlxuaW1wb3J0IHsgdXNlU3RhdGVWYWx1ZSB9IGZyb20gXCJBcHAvaGVscGVycy9TdGF0ZVByb3ZpZGVyXCJcbmltcG9ydCB7IFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayB9IGZyb20gXCJyZWFjdC1uYXRpdmVcIlxuaW1wb3J0IHsgY29sb3IgfSBmcm9tIFwiQXBwL1V0aWxzXCJcbmltcG9ydCB7IEJhZ1BsdXMgfSBmcm9tIFwiLi4vLi4vLi4vYXNzZXRzL3N2Z3NcIlxuaW1wb3J0IHsgZ29Ub0Jyb3dzZSB9IGZyb20gXCJBcHAvTmF2aWdhdGlvblwiXG5cbmNvbnN0IFNFQ1RJT05fSEVJR0hUID0gMjAwXG5cbmV4cG9ydCBjb25zdCBCYWcgPSAoKSA9PiB7XG4gIGNvbnN0IFt7IGJhZyB9LCBkaXNwYXRjaF0gPSB1c2VTdGF0ZVZhbHVlKClcbiAgY29uc3QgW2JhZ0l0ZW1zLCBzZXRCYWdJdGVtc10gPSB1c2VTdGF0ZShbXSlcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBiYWdBcnJheSA9IGJhZy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgYmFnSXRlbXMucHVzaCh7IHR5cGU6IFwiaXRlbVwiLCAuLi5pdGVtIH0pXG4gICAgfSlcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlbWFpbmluZ1BpZWNlczsgaSsrKSB7XG4gICAgICBiYWdJdGVtcy5wdXNoKHsgdHlwZTogXCJlbXB0eVwiIH0pXG4gICAgfVxuICAgIHNldEJhZ0l0ZW1zKGJhZ0FycmF5KVxuICAgIGNvbnNvbGUubG9nKFwiYmFnaXRlbXM/Pz8/XCIsIGJhZ0l0ZW1zKVxuICB9LCBbYmFnXSlcblxuICBpZiAoIWJhZyB8fCAhYmFnLml0ZW1zKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIGNvbnN0IGJhZ0lzRW1wdHkgPSBiYWcuaXRlbXMubGVuZ3RoID09PSAwXG4gIGNvbnN0IHJlbWFpbmluZ1BpZWNlcyA9IDMgLSBiYWcuaXRlbXMubGVuZ3RoXG5cbiAgY29uc3QgaGFuZGxlUmVtb3ZlID0gaWQgPT4ge1xuICAgIHJldHVybiBpZFxuICB9XG5cbiAgY29uc3QgaGFuZGxlQmFnUGx1c1ByZXNzID0gKCkgPT4ge1xuICAgIHJldHVybiBnb1RvQnJvd3NlKClcbiAgfVxuXG4gIGNvbnN0IGVtcHR5QmFnSXRlbSA9IGluZGV4ID0+IHtcbiAgICByZXR1cm4gKFxuICAgICAgPEJveCBwPXsyfSBzdHlsZT17eyBoZWlnaHQ6IFNFQ1RJT05fSEVJR0hUIH19PlxuICAgICAgICA8RmxleCBzdHlsZT17eyBmbGV4OiAyIH19IGZsZXhXcmFwPVwibm93cmFwXCIgZmxleERpcmVjdGlvbj1cImNvbHVtblwiIGp1c3RpZnlDb250ZW50PVwic3BhY2UtYmV0d2VlblwiPlxuICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICA8U2FucyBzaXplPVwiM1wiPntpbmRleCArIDF9LjwvU2Fucz5cbiAgICAgICAgICAgIDxTYW5zIHNpemU9XCIyXCIgY29sb3I9XCJncmF5XCI+XG4gICAgICAgICAgICAgIEFkZCB5b3VyIGl0ZW1cbiAgICAgICAgICAgIDwvU2Fucz5cbiAgICAgICAgICA8L0JveD5cbiAgICAgICAgICA8RmxleCBzdHlsZT17eyBmbGV4OiAyIH19IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtZW5kXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgPFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayBvblByZXNzPXsoKSA9PiBoYW5kbGVCYWdQbHVzUHJlc3MoKX0+XG4gICAgICAgICAgICAgIDxCYWdQbHVzIC8+XG4gICAgICAgICAgICA8L1RvdWNoYWJsZVdpdGhvdXRGZWVkYmFjaz5cbiAgICAgICAgICAgIDxTcGFjZXIgbXI9ezN9IC8+XG4gICAgICAgICAgPC9GbGV4PlxuICAgICAgICA8L0ZsZXg+XG4gICAgICA8L0JveD5cbiAgICApXG4gIH1cblxuICBjb25zdCBiYWdJdGVtID0gKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgY29uc3QgaW1hZ2VVUkwgPSBpdGVtLmltYWdlcyAmJiBpdGVtLmltYWdlcy5sZW5ndGggJiYgaXRlbS5pbWFnZXNbMF0udXJsXG4gICAgcmV0dXJuIChcbiAgICAgIDxCb3ggcD17Mn0ga2V5PXtpdGVtLmlkfSBzdHlsZT17eyBoZWlnaHQ6IFNFQ1RJT05fSEVJR0hUIH19PlxuICAgICAgICA8RmxleCBmbGV4RGlyZWN0aW9uPVwicm93XCIgc3R5bGU9e3sgZmxleDogMSB9fT5cbiAgICAgICAgICA8RmxleCBzdHlsZT17eyBmbGV4OiAyIH19IGZsZXhXcmFwPVwibm93cmFwXCIgZmxleERpcmVjdGlvbj1cImNvbHVtblwiIGp1c3RpZnlDb250ZW50PVwic3BhY2UtYmV0d2VlblwiPlxuICAgICAgICAgICAgPEJveD5cbiAgICAgICAgICAgICAgPFNhbnMgc2l6ZT1cIjNcIj57aW5kZXggKyAxfS48L1NhbnM+XG4gICAgICAgICAgICAgIDxTYW5zIHNpemU9XCIyXCI+e2l0ZW0uYnJhbmQubmFtZX0uPC9TYW5zPlxuICAgICAgICAgICAgICA8U2FucyBzaXplPVwiMlwiIGNvbG9yPVwiZ3JheVwiPlxuICAgICAgICAgICAgICAgIHtpdGVtLm5hbWV9LlxuICAgICAgICAgICAgICA8L1NhbnM+XG4gICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgIDxUZXh0PlxuICAgICAgICAgICAgICAgIDxTYW5zIHNpemU9XCIyXCIgY29sb3I9XCJncmF5XCI+XG4gICAgICAgICAgICAgICAgICBTaXplIHtpdGVtLm1vZGVsU2l6ZX0gfFxuICAgICAgICAgICAgICAgIDwvU2Fucz5cbiAgICAgICAgICAgICAgICB7XCIgIFwifVxuICAgICAgICAgICAgICAgIDxUb3VjaGFibGVXaXRob3V0RmVlZGJhY2tcbiAgICAgICAgICAgICAgICAgIG9uUHJlc3M9eygpID0+XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInJlbW92ZUl0ZW1Gcm9tQmFnXCIsXG4gICAgICAgICAgICAgICAgICAgICAgaXRlbTogaXRlbSxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8U2FucyBzaXplPVwiMlwiIGNvbG9yPVwiYmx1ZVwiPlxuICAgICAgICAgICAgICAgICAgICBSZW1vdmVcbiAgICAgICAgICAgICAgICAgIDwvU2Fucz5cbiAgICAgICAgICAgICAgICA8L1RvdWNoYWJsZVdpdGhvdXRGZWVkYmFjaz5cbiAgICAgICAgICAgICAgPC9UZXh0PlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPC9GbGV4PlxuICAgICAgICAgIDxGbGV4IHN0eWxlPXt7IGZsZXg6IDIgfX0gZmxleERpcmVjdGlvbj1cInJvd1wiIGp1c3RpZnlDb250ZW50PVwiZmxleC1lbmRcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCI+XG4gICAgICAgICAgICA8SW1hZ2Ugc3R5bGU9e3sgaGVpZ2h0OiBTRUNUSU9OX0hFSUdIVCwgd2lkdGg6IDE2MCB9fSByZXNpemVNb2RlPVwiY29udGFpblwiIHNvdXJjZT17eyB1cmk6IGltYWdlVVJMIH19IC8+XG4gICAgICAgICAgPC9GbGV4PlxuICAgICAgICA8L0ZsZXg+XG4gICAgICA8L0JveD5cbiAgICApXG4gIH1cblxuICBjb25zdCByZW5kZXJJdGVtID0gKHsgaXRlbSwgaW5kZXggfSkgPT4ge1xuICAgIHJldHVybiBpdGVtLnR5cGUgPT09IFwiaXRlbVwiID8gYmFnSXRlbShpdGVtLCBpbmRleCkgOiBlbXB0eUJhZ0l0ZW0oaW5kZXgpXG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxUaGVtZT5cbiAgICAgIDxDb250YWluZXI+XG4gICAgICAgIDxCb3ggc3R5bGU9e3sgZmxleDogMSB9fT5cbiAgICAgICAgICA8U3BhY2VyIG1iPXszfSAvPlxuICAgICAgICAgIHtiYWdJc0VtcHR5ID8gKFxuICAgICAgICAgICAgPEZsZXggZmxleD17MX0gZmxleERpcmVjdGlvbj1cImNvbHVtblwiIGp1c3RpZnlDb250ZW50PVwiY2VudGVyXCIgYWxpZ25Db250ZW50PVwiY2VudGVyXCI+XG4gICAgICAgICAgICAgIDxFbXB0eVN0YXRlIHJlbWFpbmluZ1BpZWNlcz17cmVtYWluaW5nUGllY2VzfSAvPlxuICAgICAgICAgICAgPC9GbGV4PlxuICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICA8Qm94PlxuICAgICAgICAgICAgICA8U3BhY2VyIG1iPXszfSAvPlxuICAgICAgICAgICAgICA8RmxhdExpc3RcbiAgICAgICAgICAgICAgICBkYXRhPXtiYWdJdGVtc31cbiAgICAgICAgICAgICAgICBMaXN0SGVhZGVyQ29tcG9uZW50PXsoKSA9PiAoXG4gICAgICAgICAgICAgICAgICA8Qm94IHA9ezJ9PlxuICAgICAgICAgICAgICAgICAgICA8U2FucyBzaXplPVwiM1wiIGNvbG9yPVwiYmxhY2tcIj5cbiAgICAgICAgICAgICAgICAgICAgICBNeSBiYWdcbiAgICAgICAgICAgICAgICAgICAgPC9TYW5zPlxuICAgICAgICAgICAgICAgICAgICA8U2FucyBzaXplPVwiMlwiIGNvbG9yPVwiZ3JheVwiPlxuICAgICAgICAgICAgICAgICAgICAgIFlvdSBoYXZlIHtyZW1haW5pbmdQaWVjZXN9IHBpZWNlcyByZW1haW5pbmdcbiAgICAgICAgICAgICAgICAgICAgPC9TYW5zPlxuICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICBJdGVtU2VwYXJhdG9yQ29tcG9uZW50PXsoKSA9PiAoXG4gICAgICAgICAgICAgICAgICA8Qm94IHB4PXsyfT5cbiAgICAgICAgICAgICAgICAgICAgPFNwYWNlciBtYj17Mn0gLz5cbiAgICAgICAgICAgICAgICAgICAgPFNlcGFyYXRvciBjb2xvcj17Y29sb3IoXCJsaWdodEdyYXlcIil9IC8+XG4gICAgICAgICAgICAgICAgICAgIDxTcGFjZXIgbWI9ezJ9IC8+XG4gICAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIGtleUV4dHJhY3Rvcj17KF9pdGVtLCBpbmRleCkgPT4gU3RyaW5nKGluZGV4KX1cbiAgICAgICAgICAgICAgICByZW5kZXJJdGVtPXtpdGVtID0+IHJlbmRlckl0ZW0oaXRlbSl9XG4gICAgICAgICAgICAgICAgTGlzdEZvb3RlckNvbXBvbmVudD17KCkgPT4gPFNwYWNlciBtYj17MjAwfSAvPn1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvQm94PlxuICAgICAgPC9Db250YWluZXI+XG4gICAgPC9UaGVtZT5cbiAgKVxufVxuIl19