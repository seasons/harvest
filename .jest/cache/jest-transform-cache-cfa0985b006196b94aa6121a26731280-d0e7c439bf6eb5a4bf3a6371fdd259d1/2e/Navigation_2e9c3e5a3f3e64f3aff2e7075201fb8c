3e4442921657bb2a64f3e9a3462e7f3b
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

Object.defineProperty(exports, "__esModule", {
  value: true
});

var lodash_1 = require("lodash");

var NativeCommandsSender_1 = require("./adapters/NativeCommandsSender");

var NativeEventsReceiver_1 = require("./adapters/NativeEventsReceiver");

var UniqueIdProvider_1 = require("./adapters/UniqueIdProvider");

var Store_1 = require("./components/Store");

var ComponentRegistry_1 = require("./components/ComponentRegistry");

var Commands_1 = require("./commands/Commands");

var LayoutTreeParser_1 = require("./commands/LayoutTreeParser");

var LayoutTreeCrawler_1 = require("./commands/LayoutTreeCrawler");

var EventsRegistry_1 = require("./events/EventsRegistry");

var SharedElement_1 = require("./adapters/SharedElement");

var CommandsObserver_1 = require("./events/CommandsObserver");

var Constants_1 = require("./adapters/Constants");

var ComponentEventsObserver_1 = require("./events/ComponentEventsObserver");

var TouchablePreview_1 = require("./adapters/TouchablePreview");

var ComponentWrapper_1 = require("./components/ComponentWrapper");

var OptionsProcessor_1 = require("./commands/OptionsProcessor");

var ColorService_1 = require("./adapters/ColorService");

var AssetResolver_1 = require("./adapters/AssetResolver");

var AppRegistryService_1 = require("./adapters/AppRegistryService");

var NavigationRoot = function () {
  function NavigationRoot() {
    (0, _classCallCheck2.default)(this, NavigationRoot);
    this.Element = SharedElement_1.SharedElement;
    this.TouchablePreview = TouchablePreview_1.TouchablePreview;
    this.componentWrapper = new ComponentWrapper_1.ComponentWrapper();
    this.store = new Store_1.Store();
    this.nativeEventsReceiver = new NativeEventsReceiver_1.NativeEventsReceiver();
    this.uniqueIdProvider = new UniqueIdProvider_1.UniqueIdProvider();
    this.componentEventsObserver = new ComponentEventsObserver_1.ComponentEventsObserver(this.nativeEventsReceiver, this.store);
    var appRegistryService = new AppRegistryService_1.AppRegistryService();
    this.componentRegistry = new ComponentRegistry_1.ComponentRegistry(this.store, this.componentEventsObserver, this.componentWrapper, appRegistryService);
    this.layoutTreeParser = new LayoutTreeParser_1.LayoutTreeParser(this.uniqueIdProvider);
    var optionsProcessor = new OptionsProcessor_1.OptionsProcessor(this.store, this.uniqueIdProvider, new ColorService_1.ColorService(), new AssetResolver_1.AssetService());
    this.layoutTreeCrawler = new LayoutTreeCrawler_1.LayoutTreeCrawler(this.store, optionsProcessor);
    this.nativeCommandsSender = new NativeCommandsSender_1.NativeCommandsSender();
    this.commandsObserver = new CommandsObserver_1.CommandsObserver(this.uniqueIdProvider);
    this.commands = new Commands_1.Commands(this.nativeCommandsSender, this.layoutTreeParser, this.layoutTreeCrawler, this.commandsObserver, this.uniqueIdProvider, optionsProcessor);
    this.eventsRegistry = new EventsRegistry_1.EventsRegistry(this.nativeEventsReceiver, this.commandsObserver, this.componentEventsObserver);
    this.componentEventsObserver.registerOnceForAllComponentEvents();
  }

  (0, _createClass2.default)(NavigationRoot, [{
    key: "registerComponent",
    value: function registerComponent(componentName, componentProvider, concreteComponentProvider) {
      return this.componentRegistry.registerComponent(componentName, componentProvider, concreteComponentProvider);
    }
  }, {
    key: "registerComponentWithRedux",
    value: function registerComponentWithRedux(componentName, getComponentClassFunc, ReduxProvider, reduxStore) {
      return this.componentRegistry.registerComponent(componentName, getComponentClassFunc, undefined, ReduxProvider, reduxStore);
    }
  }, {
    key: "setRoot",
    value: function setRoot(layout) {
      return this.commands.setRoot(layout);
    }
  }, {
    key: "setDefaultOptions",
    value: function setDefaultOptions(options) {
      this.commands.setDefaultOptions(options);
    }
  }, {
    key: "mergeOptions",
    value: function mergeOptions(componentId, options) {
      this.commands.mergeOptions(componentId, options);
    }
  }, {
    key: "showModal",
    value: function showModal(layout) {
      return this.commands.showModal(layout);
    }
  }, {
    key: "dismissModal",
    value: function dismissModal(componentId, mergeOptions) {
      return this.commands.dismissModal(componentId, mergeOptions);
    }
  }, {
    key: "dismissAllModals",
    value: function dismissAllModals(mergeOptions) {
      return this.commands.dismissAllModals(mergeOptions);
    }
  }, {
    key: "push",
    value: function push(componentId, layout) {
      return this.commands.push(componentId, layout);
    }
  }, {
    key: "pop",
    value: function pop(componentId, mergeOptions) {
      return this.commands.pop(componentId, mergeOptions);
    }
  }, {
    key: "popTo",
    value: function popTo(componentId, mergeOptions) {
      return this.commands.popTo(componentId, mergeOptions);
    }
  }, {
    key: "popToRoot",
    value: function popToRoot(componentId, mergeOptions) {
      return this.commands.popToRoot(componentId, mergeOptions);
    }
  }, {
    key: "setStackRoot",
    value: function setStackRoot(componentId, layout) {
      var children = lodash_1.isArray(layout) ? layout : [layout];
      return this.commands.setStackRoot(componentId, children);
    }
  }, {
    key: "showOverlay",
    value: function showOverlay(layout) {
      return this.commands.showOverlay(layout);
    }
  }, {
    key: "dismissOverlay",
    value: function dismissOverlay(componentId) {
      return this.commands.dismissOverlay(componentId);
    }
  }, {
    key: "getLaunchArgs",
    value: function getLaunchArgs() {
      return this.commands.getLaunchArgs();
    }
  }, {
    key: "events",
    value: function events() {
      return this.eventsRegistry;
    }
  }, {
    key: "constants",
    value: function constants() {
      return _regenerator.default.async(function constants$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return _regenerator.default.awrap(Constants_1.Constants.get());

            case 2:
              return _context.abrupt("return", _context.sent);

            case 3:
            case "end":
              return _context.stop();
          }
        }
      });
    }
  }]);
  return NavigationRoot;
}();

exports.NavigationRoot = NavigationRoot;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk5hdmlnYXRpb24uanMiXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJsb2Rhc2hfMSIsInJlcXVpcmUiLCJOYXRpdmVDb21tYW5kc1NlbmRlcl8xIiwiTmF0aXZlRXZlbnRzUmVjZWl2ZXJfMSIsIlVuaXF1ZUlkUHJvdmlkZXJfMSIsIlN0b3JlXzEiLCJDb21wb25lbnRSZWdpc3RyeV8xIiwiQ29tbWFuZHNfMSIsIkxheW91dFRyZWVQYXJzZXJfMSIsIkxheW91dFRyZWVDcmF3bGVyXzEiLCJFdmVudHNSZWdpc3RyeV8xIiwiU2hhcmVkRWxlbWVudF8xIiwiQ29tbWFuZHNPYnNlcnZlcl8xIiwiQ29uc3RhbnRzXzEiLCJDb21wb25lbnRFdmVudHNPYnNlcnZlcl8xIiwiVG91Y2hhYmxlUHJldmlld18xIiwiQ29tcG9uZW50V3JhcHBlcl8xIiwiT3B0aW9uc1Byb2Nlc3Nvcl8xIiwiQ29sb3JTZXJ2aWNlXzEiLCJBc3NldFJlc29sdmVyXzEiLCJBcHBSZWdpc3RyeVNlcnZpY2VfMSIsIk5hdmlnYXRpb25Sb290IiwiRWxlbWVudCIsIlNoYXJlZEVsZW1lbnQiLCJUb3VjaGFibGVQcmV2aWV3IiwiY29tcG9uZW50V3JhcHBlciIsIkNvbXBvbmVudFdyYXBwZXIiLCJzdG9yZSIsIlN0b3JlIiwibmF0aXZlRXZlbnRzUmVjZWl2ZXIiLCJOYXRpdmVFdmVudHNSZWNlaXZlciIsInVuaXF1ZUlkUHJvdmlkZXIiLCJVbmlxdWVJZFByb3ZpZGVyIiwiY29tcG9uZW50RXZlbnRzT2JzZXJ2ZXIiLCJDb21wb25lbnRFdmVudHNPYnNlcnZlciIsImFwcFJlZ2lzdHJ5U2VydmljZSIsIkFwcFJlZ2lzdHJ5U2VydmljZSIsImNvbXBvbmVudFJlZ2lzdHJ5IiwiQ29tcG9uZW50UmVnaXN0cnkiLCJsYXlvdXRUcmVlUGFyc2VyIiwiTGF5b3V0VHJlZVBhcnNlciIsIm9wdGlvbnNQcm9jZXNzb3IiLCJPcHRpb25zUHJvY2Vzc29yIiwiQ29sb3JTZXJ2aWNlIiwiQXNzZXRTZXJ2aWNlIiwibGF5b3V0VHJlZUNyYXdsZXIiLCJMYXlvdXRUcmVlQ3Jhd2xlciIsIm5hdGl2ZUNvbW1hbmRzU2VuZGVyIiwiTmF0aXZlQ29tbWFuZHNTZW5kZXIiLCJjb21tYW5kc09ic2VydmVyIiwiQ29tbWFuZHNPYnNlcnZlciIsImNvbW1hbmRzIiwiQ29tbWFuZHMiLCJldmVudHNSZWdpc3RyeSIsIkV2ZW50c1JlZ2lzdHJ5IiwicmVnaXN0ZXJPbmNlRm9yQWxsQ29tcG9uZW50RXZlbnRzIiwiY29tcG9uZW50TmFtZSIsImNvbXBvbmVudFByb3ZpZGVyIiwiY29uY3JldGVDb21wb25lbnRQcm92aWRlciIsInJlZ2lzdGVyQ29tcG9uZW50IiwiZ2V0Q29tcG9uZW50Q2xhc3NGdW5jIiwiUmVkdXhQcm92aWRlciIsInJlZHV4U3RvcmUiLCJ1bmRlZmluZWQiLCJsYXlvdXQiLCJzZXRSb290Iiwib3B0aW9ucyIsInNldERlZmF1bHRPcHRpb25zIiwiY29tcG9uZW50SWQiLCJtZXJnZU9wdGlvbnMiLCJzaG93TW9kYWwiLCJkaXNtaXNzTW9kYWwiLCJkaXNtaXNzQWxsTW9kYWxzIiwicHVzaCIsInBvcCIsInBvcFRvIiwicG9wVG9Sb290IiwiY2hpbGRyZW4iLCJpc0FycmF5Iiwic2V0U3RhY2tSb290Iiwic2hvd092ZXJsYXkiLCJkaXNtaXNzT3ZlcmxheSIsImdldExhdW5jaEFyZ3MiLCJDb25zdGFudHMiLCJnZXQiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7O0FBQ0FBLE1BQU0sQ0FBQ0MsY0FBUCxDQUFzQkMsT0FBdEIsRUFBK0IsWUFBL0IsRUFBNkM7QUFBRUMsRUFBQUEsS0FBSyxFQUFFO0FBQVQsQ0FBN0M7O0FBQ0EsSUFBTUMsUUFBUSxHQUFHQyxPQUFPLENBQUMsUUFBRCxDQUF4Qjs7QUFDQSxJQUFNQyxzQkFBc0IsR0FBR0QsT0FBTyxtQ0FBdEM7O0FBQ0EsSUFBTUUsc0JBQXNCLEdBQUdGLE9BQU8sbUNBQXRDOztBQUNBLElBQU1H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Ozs7Ozs7Ozs7OztBQUdyQnRGLE9BQU8sQ0FBQ3VCLGNBQVIsR0FBeUJBLGNBQXpCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5jb25zdCBsb2Rhc2hfMSA9IHJlcXVpcmUoXCJsb2Rhc2hcIik7XG5jb25zdCBOYXRpdmVDb21tYW5kc1NlbmRlcl8xID0gcmVxdWlyZShcIi4vYWRhcHRlcnMvTmF0aXZlQ29tbWFuZHNTZW5kZXJcIik7XG5jb25zdCBOYXRpdmVFdmVudHNSZWNlaXZlcl8xID0gcmVxdWlyZShcIi4vYWRhcHRlcnMvTmF0aXZlRXZlbnRzUmVjZWl2ZXJcIik7XG5jb25zdCBVbmlxdWVJZFByb3ZpZGVyXzEgPSByZXF1aXJlKFwiLi9hZGFwdGVycy9VbmlxdWVJZFByb3ZpZGVyXCIpO1xuY29uc3QgU3RvcmVfMSA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudHMvU3RvcmVcIik7XG5jb25zdCBDb21wb25lbnRSZWdpc3RyeV8xID0gcmVxdWlyZShcIi4vY29tcG9uZW50cy9Db21wb25lbnRSZWdpc3RyeVwiKTtcbmNvbnN0IENvbW1hbmRzXzEgPSByZXF1aXJlKFwiLi9jb21tYW5kcy9Db21tYW5kc1wiKTtcbmNvbnN0IExheW91dFRyZWVQYXJzZXJfMSA9IHJlcXVpcmUoXCIuL2NvbW1hbmRzL0xheW91dFRyZWVQYXJzZXJcIik7XG5jb25zdCBMYXlvdXRUcmVlQ3Jhd2xlcl8xID0gcmVxdWlyZShcIi4vY29tbWFuZHMvTGF5b3V0VHJlZUNyYXdsZXJcIik7XG5jb25zdCBFdmVudHNSZWdpc3RyeV8xID0gcmVxdWlyZShcIi4vZXZlbnRzL0V2ZW50c1JlZ2lzdHJ5XCIpO1xuY29uc3QgU2hhcmVkRWxlbWVudF8xID0gcmVxdWlyZShcIi4vYWRhcHRlcnMvU2hhcmVkRWxlbWVudFwiKTtcbmNvbnN0IENvbW1hbmRzT2JzZXJ2ZXJfMSA9IHJlcXVpcmUoXCIuL2V2ZW50cy9Db21tYW5kc09ic2VydmVyXCIpO1xuY29uc3QgQ29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9hZGFwdGVycy9Db25zdGFudHNcIik7XG5jb25zdCBDb21wb25lbnRFdmVudHNPYnNlcnZlcl8xID0gcmVxdWlyZShcIi4vZXZlbnRzL0NvbXBvbmVudEV2ZW50c09ic2VydmVyXCIpO1xuY29uc3QgVG91Y2hhYmxlUHJldmlld18xID0gcmVxdWlyZShcIi4vYWRhcHRlcnMvVG91Y2hhYmxlUHJldmlld1wiKTtcbmNvbnN0IENvbXBvbmVudFdyYXBwZXJfMSA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudHMvQ29tcG9uZW50V3JhcHBlclwiKTtcbmNvbnN0IE9wdGlvbnNQcm9jZXNzb3JfMSA9IHJlcXVpcmUoXCIuL2NvbW1hbmRzL09wdGlvbnNQcm9jZXNzb3JcIik7XG5jb25zdCBDb2xvclNlcnZpY2VfMSA9IHJlcXVpcmUoXCIuL2FkYXB0ZXJzL0NvbG9yU2VydmljZVwiKTtcbmNvbnN0IEFzc2V0UmVzb2x2ZXJfMSA9IHJlcXVpcmUoXCIuL2FkYXB0ZXJzL0Fzc2V0UmVzb2x2ZXJcIik7XG5jb25zdCBBcHBSZWdpc3RyeVNlcnZpY2VfMSA9IHJlcXVpcmUoXCIuL2FkYXB0ZXJzL0FwcFJlZ2lzdHJ5U2VydmljZVwiKTtcbmNsYXNzIE5hdmlnYXRpb25Sb290IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5FbGVtZW50ID0gU2hhcmVkRWxlbWVudF8xLlNoYXJlZEVsZW1lbnQ7XG4gICAgICAgIHRoaXMuVG91Y2hhYmxlUHJldmlldyA9IFRvdWNoYWJsZVByZXZpZXdfMS5Ub3VjaGFibGVQcmV2aWV3O1xuICAgICAgICB0aGlzLmNvbXBvbmVudFdyYXBwZXIgPSBuZXcgQ29tcG9uZW50V3JhcHBlcl8xLkNvbXBvbmVudFdyYXBwZXIoKTtcbiAgICAgICAgdGhpcy5zdG9yZSA9IG5ldyBTdG9yZV8xLlN0b3JlKCk7XG4gICAgICAgIHRoaXMubmF0aXZlRXZlbnRzUmVjZWl2ZXIgPSBuZXcgTmF0aXZlRXZlbnRzUmVjZWl2ZXJfMS5OYXRpdmVFdmVudHNSZWNlaXZlcigpO1xuICAgICAgICB0aGlzLnVuaXF1ZUlkUHJvdmlkZXIgPSBuZXcgVW5pcXVlSWRQcm92aWRlcl8xLlVuaXF1ZUlkUHJvdmlkZXIoKTtcbiAgICAgICAgdGhpcy5jb21wb25lbnRFdmVudHNPYnNlcnZlciA9IG5ldyBDb21wb25lbnRFdmVudHNPYnNlcnZlcl8xLkNvbXBvbmVudEV2ZW50c09ic2VydmVyKHRoaXMubmF0aXZlRXZlbnRzUmVjZWl2ZXIsIHRoaXMuc3RvcmUpO1xuICAgICAgICBjb25zdCBhcHBSZWdpc3RyeVNlcnZpY2UgPSBuZXcgQXBwUmVnaXN0cnlTZXJ2aWNlXzEuQXBwUmVnaXN0cnlTZXJ2aWNlKCk7XG4gICAgICAgIHRoaXMuY29tcG9uZW50UmVnaXN0cnkgPSBuZXcgQ29tcG9uZW50UmVnaXN0cnlfMS5Db21wb25lbnRSZWdpc3RyeSh0aGlzLnN0b3JlLCB0aGlzLmNvbXBvbmVudEV2ZW50c09ic2VydmVyLCB0aGlzLmNvbXBvbmVudFdyYXBwZXIsIGFwcFJlZ2lzdHJ5U2VydmljZSk7XG4gICAgICAgIHRoaXMubGF5b3V0VHJlZVBhcnNlciA9IG5ldyBMYXlvdXRUcmVlUGFyc2VyXzEuTGF5b3V0VHJlZVBhcnNlcih0aGlzLnVuaXF1ZUlkUHJvdmlkZXIpO1xuICAgICAgICBjb25zdCBvcHRpb25zUHJvY2Vzc29yID0gbmV3IE9wdGlvbnNQcm9jZXNzb3JfMS5PcHRpb25zUHJvY2Vzc29yKHRoaXMuc3RvcmUsIHRoaXMudW5pcXVlSWRQcm92aWRlciwgbmV3IENvbG9yU2VydmljZV8xLkNvbG9yU2VydmljZSgpLCBuZXcgQXNzZXRSZXNvbHZlcl8xLkFzc2V0U2VydmljZSgpKTtcbiAgICAgICAgdGhpcy5sYXlvdXRUcmVlQ3Jhd2xlciA9IG5ldyBMYXlvdXRUcmVlQ3Jhd2xlcl8xLkxheW91dFRyZWVDcmF3bGVyKHRoaXMuc3RvcmUsIG9wdGlvbnNQcm9jZXNzb3IpO1xuICAgICAgICB0aGlzLm5hdGl2ZUNvbW1hbmRzU2VuZGVyID0gbmV3IE5hdGl2ZUNvbW1hbmRzU2VuZGVyXzEuTmF0aXZlQ29tbWFuZHNTZW5kZXIoKTtcbiAgICAgICAgdGhpcy5jb21tYW5kc09ic2VydmVyID0gbmV3IENvbW1hbmRzT2JzZXJ2ZXJfMS5Db21tYW5kc09ic2VydmVyKHRoaXMudW5pcXVlSWRQcm92aWRlcik7XG4gICAgICAgIHRoaXMuY29tbWFuZHMgPSBuZXcgQ29tbWFuZHNfMS5Db21tYW5kcyh0aGlzLm5hdGl2ZUNvbW1hbmRzU2VuZGVyLCB0aGlzLmxheW91dFRyZWVQYXJzZXIsIHRoaXMubGF5b3V0VHJlZUNyYXdsZXIsIHRoaXMuY29tbWFuZHNPYnNlcnZlciwgdGhpcy51bmlxdWVJZFByb3ZpZGVyLCBvcHRpb25zUHJvY2Vzc29yKTtcbiAgICAgICAgdGhpcy5ldmVudHNSZWdpc3RyeSA9IG5ldyBFdmVudHNSZWdpc3RyeV8xLkV2ZW50c1JlZ2lzdHJ5KHRoaXMubmF0aXZlRXZlbnRzUmVjZWl2ZXIsIHRoaXMuY29tbWFuZHNPYnNlcnZlciwgdGhpcy5jb21wb25lbnRFdmVudHNPYnNlcnZlcik7XG4gICAgICAgIHRoaXMuY29tcG9uZW50RXZlbnRzT2JzZXJ2ZXIucmVnaXN0ZXJPbmNlRm9yQWxsQ29tcG9uZW50RXZlbnRzKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV2ZXJ5IG5hdmlnYXRpb24gY29tcG9uZW50IGluIHlvdXIgYXBwIG11c3QgYmUgcmVnaXN0ZXJlZCB3aXRoIGEgdW5pcXVlIG5hbWUuXG4gICAgICogVGhlIGNvbXBvbmVudCBpdHNlbGYgaXMgYSB0cmFkaXRpb25hbCBSZWFjdCBjb21wb25lbnQgZXh0ZW5kaW5nIFJlYWN0LkNvbXBvbmVudC5cbiAgICAgKi9cbiAgICByZWdpc3RlckNvbXBvbmVudChjb21wb25lbnROYW1lLCBjb21wb25lbnRQcm92aWRlciwgY29uY3JldGVDb21wb25lbnRQcm92aWRlcikge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnRSZWdpc3RyeS5yZWdpc3RlckNvbXBvbmVudChjb21wb25lbnROYW1lLCBjb21wb25lbnRQcm92aWRlciwgY29uY3JldGVDb21wb25lbnRQcm92aWRlcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFV0aWxpdHkgaGVscGVyIGZ1bmN0aW9uIGxpa2UgcmVnaXN0ZXJDb21wb25lbnQsXG4gICAgICogd3JhcHMgdGhlIHByb3ZpZGVkIGNvbXBvbmVudCB3aXRoIGEgcmVhY3QtcmVkdXggUHJvdmlkZXIgd2l0aCB0aGUgcGFzc2VkIHJlZHV4IHN0b3JlXG4gICAgICovXG4gICAgcmVnaXN0ZXJDb21wb25lbnRXaXRoUmVkdXgoY29tcG9uZW50TmFtZSwgZ2V0Q29tcG9uZW50Q2xhc3NGdW5jLCBSZWR1eFByb3ZpZGVyLCByZWR1eFN0b3JlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudFJlZ2lzdHJ5LnJlZ2lzdGVyQ29tcG9uZW50KGNvbXBvbmVudE5hbWUsIGdldENvbXBvbmVudENsYXNzRnVuYywgdW5kZWZpbmVkLCBSZWR1eFByb3ZpZGVyLCByZWR1eFN0b3JlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXQgdGhlIGFwcCB0byBhIG5ldyBsYXlvdXRcbiAgICAgKi9cbiAgICBzZXRSb290KGxheW91dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21tYW5kcy5zZXRSb290KGxheW91dCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCBkZWZhdWx0IG9wdGlvbnMgdG8gYWxsIHNjcmVlbnMuIFVzZWZ1bCBmb3IgZGVjbGFyaW5nIGEgY29uc2lzdGVudCBzdHlsZSBhY3Jvc3MgdGhlIGFwcC5cbiAgICAgKi9cbiAgICBzZXREZWZhdWx0T3B0aW9ucyhvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuY29tbWFuZHMuc2V0RGVmYXVsdE9wdGlvbnMob3B0aW9ucyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoYW5nZSBhIGNvbXBvbmVudCdzIG5hdmlnYXRpb24gb3B0aW9uc1xuICAgICAqL1xuICAgIG1lcmdlT3B0aW9ucyhjb21wb25lbnRJZCwgb3B0aW9ucykge1xuICAgICAgICB0aGlzLmNvbW1hbmRzLm1lcmdlT3B0aW9ucyhjb21wb25lbnRJZCwgb3B0aW9ucyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNob3cgYSBzY3JlZW4gYXMgYSBtb2RhbC5cbiAgICAgKi9cbiAgICBzaG93TW9kYWwobGF5b3V0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbW1hbmRzLnNob3dNb2RhbChsYXlvdXQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEaXNtaXNzIGEgbW9kYWwgYnkgY29tcG9uZW50SWQuIFRoZSBkaXNtaXNzZWQgbW9kYWwgY2FuIGJlIGFueXdoZXJlIGluIHRoZSBzdGFjay5cbiAgICAgKi9cbiAgICBkaXNtaXNzTW9kYWwoY29tcG9uZW50SWQsIG1lcmdlT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21tYW5kcy5kaXNtaXNzTW9kYWwoY29tcG9uZW50SWQsIG1lcmdlT3B0aW9ucyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERpc21pc3MgYWxsIE1vZGFsc1xuICAgICAqL1xuICAgIGRpc21pc3NBbGxNb2RhbHMobWVyZ2VPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbW1hbmRzLmRpc21pc3NBbGxNb2RhbHMobWVyZ2VPcHRpb25zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHVzaCBhIG5ldyBsYXlvdXQgaW50byB0aGlzIHNjcmVlbidzIG5hdmlnYXRpb24gc3RhY2suXG4gICAgICovXG4gICAgcHVzaChjb21wb25lbnRJZCwgbGF5b3V0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbW1hbmRzLnB1c2goY29tcG9uZW50SWQsIGxheW91dCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBvcCBhIGNvbXBvbmVudCBmcm9tIHRoZSBzdGFjaywgcmVnYXJkbGVzcyBvZiBpdCdzIHBvc2l0aW9uLlxuICAgICAqL1xuICAgIHBvcChjb21wb25lbnRJZCwgbWVyZ2VPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbW1hbmRzLnBvcChjb21wb25lbnRJZCwgbWVyZ2VPcHRpb25zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUG9wIHRoZSBzdGFjayB0byBhIGdpdmVuIGNvbXBvbmVudFxuICAgICAqL1xuICAgIHBvcFRvKGNvbXBvbmVudElkLCBtZXJnZU9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tbWFuZHMucG9wVG8oY29tcG9uZW50SWQsIG1lcmdlT3B0aW9ucyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBvcCB0aGUgY29tcG9uZW50J3Mgc3RhY2sgdG8gcm9vdC5cbiAgICAgKi9cbiAgICBwb3BUb1Jvb3QoY29tcG9uZW50SWQsIG1lcmdlT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21tYW5kcy5wb3BUb1Jvb3QoY29tcG9uZW50SWQsIG1lcmdlT3B0aW9ucyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgbmV3IHJvb3QgY29tcG9uZW50IHRvIHN0YWNrLlxuICAgICAqL1xuICAgIHNldFN0YWNrUm9vdChjb21wb25lbnRJZCwgbGF5b3V0KSB7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gbG9kYXNoXzEuaXNBcnJheShsYXlvdXQpID8gbGF5b3V0IDogW2xheW91dF07XG4gICAgICAgIHJldHVybiB0aGlzLmNvbW1hbmRzLnNldFN0YWNrUm9vdChjb21wb25lbnRJZCwgY2hpbGRyZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTaG93IG92ZXJsYXkgb24gdG9wIG9mIHRoZSBlbnRpcmUgYXBwXG4gICAgICovXG4gICAgc2hvd092ZXJsYXkobGF5b3V0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbW1hbmRzLnNob3dPdmVybGF5KGxheW91dCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIGRpc21pc3Mgb3ZlcmxheSBieSBjb21wb25lbnRJZFxuICAgICAqL1xuICAgIGRpc21pc3NPdmVybGF5KGNvbXBvbmVudElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbW1hbmRzLmRpc21pc3NPdmVybGF5KGNvbXBvbmVudElkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzb2x2ZXMgYXJndW1lbnRzIHBhc3NlZCBvbiBsYXVuY2hcbiAgICAgKi9cbiAgICBnZXRMYXVuY2hBcmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb21tYW5kcy5nZXRMYXVuY2hBcmdzKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9idGFpbiB0aGUgZXZlbnRzIHJlZ2lzdHJ5IGluc3RhbmNlXG4gICAgICovXG4gICAgZXZlbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ldmVudHNSZWdpc3RyeTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29uc3RhbnRzIGNvbWluZyBmcm9tIG5hdGl2ZVxuICAgICAqL1xuICAgIGFzeW5jIGNvbnN0YW50cygpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IENvbnN0YW50c18xLkNvbnN0YW50cy5nZXQoKTtcbiAgICB9XG59XG5leHBvcnRzLk5hdmlnYXRpb25Sb290ID0gTmF2aWdhdGlvblJvb3Q7XG4iXX0=