22068a3ec9ff4dc3a2c69bff3c828add
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

var Platform = require('Platform');

var deepDiffer = require('deepDiffer');

var React = require('React');

var View = require('View');

var VirtualizedList = require('VirtualizedList');

var StyleSheet = require('StyleSheet');

var invariant = require('invariant');

var defaultProps = _objectSpread({}, VirtualizedList.defaultProps, {
  numColumns: 1,
  removeClippedSubviews: Platform.OS === 'android'
});

var FlatList = function (_React$PureComponent) {
  (0, _inherits2.default)(FlatList, _React$PureComponent);
  (0, _createClass2.default)(FlatList, [{
    key: "scrollToEnd",
    value: function scrollToEnd(params) {
      if (this._listRef) {
        this._listRef.scrollToEnd(params);
      }
    }
  }, {
    key: "scrollToIndex",
    value: function scrollToIndex(params) {
      if (this._listRef) {
        this._listRef.scrollToIndex(params);
      }
    }
  }, {
    key: "scrollToItem",
    value: function scrollToItem(params) {
      if (this._listRef) {
        this._listRef.scrollToItem(params);
      }
    }
  }, {
    key: "scrollToOffset",
    value: function scrollToOffset(params) {
      if (this._listRef) {
        this._listRef.scrollToOffset(params);
      }
    }
  }, {
    key: "recordInteraction",
    value: function recordInteraction() {
      if (this._listRef) {
        this._listRef.recordInteraction();
      }
    }
  }, {
    key: "flashScrollIndicators",
    value: function flashScrollIndicators() {
      if (this._listRef) {
        this._listRef.flashScrollIndicators();
      }
    }
  }, {
    key: "getScrollResponder",
    value: function getScrollResponder() {
      if (this._listRef) {
        return this._listRef.getScrollResponder();
      }
    }
  }, {
    key: "getScrollableNode",
    value: function getScrollableNode() {
      if (this._listRef) {
        return this._listRef.getScrollableNode();
      }
    }
  }, {
    key: "setNativeProps",
    value: function setNativeProps(props) {
      if (this._listRef) {
        this._listRef.setNativeProps(props);
      }
    }
  }]);

  function FlatList(props) {
    var _this;

    (0, _classCallCheck2.default)(this, FlatList);
    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(FlatList).call(this, props));
    _this._virtualizedListPairs = [];

    _this._captureRef = function (ref) {
      _this._listRef = ref;
    };

    _this._getItem = function (data, index) {
      var numColumns = _this.props.numColumns;

      if (numColumns > 1) {
        var ret = [];

        for (var kk = 0; kk < numColumns; kk++) {
          var _item = data[index * numColumns + kk];

          if (_item != null) {
            ret.push(_item);
          }
        }

        return ret;
      } else {
        return data[index];
      }
    };

    _this._getItemCount = function (data) {
      return data ? Math.ceil(data.length / _this.props.numColumns) : 0;
    };

    _this._keyExtractor = function (items, index) {
      var _this$props = _this.props,
          keyExtractor = _this$props.keyExtractor,
          numColumns = _this$props.numColumns;

      if (numColumns > 1) {
        invariant(Array.isArray(items), 'FlatList: Encountered internal consistency error, expected each item to consist of an ' + 'array with 1-%s columns; instead, received a single item.', numColumns);
        return items.map(function (it, kk) {
          return keyExtractor(it, index * numColumns + kk);
        }).join(':');
      } else {
        return keyExtractor(items, index);
      }
    };

    _this._renderItem = function (info) {
      var _this$props2 = _this.props,
          renderItem = _this$props2.renderItem,
          numColumns = _this$props2.numColumns,
          columnWrapperStyle = _this$props2.columnWrapperStyle;

      if (numColumns > 1) {
        var _item2 = info.item,
            _index = info.index;
        invariant(Array.isArray(_item2), 'Expected array of items with numColumns > 1');
        return React.createElement(View, {
          style: StyleSheet.compose(styles.row, columnWrapperStyle)
        }, _item2.map(function (it, kk) {
          var element = renderItem({
            item: it,
            index: _index * numColumns + kk,
            separators: info.separators
          });
          return element && React.cloneElement(element, {
            key: kk
          });
        }));
      } else {
        return renderItem(info);
      }
    };

    _this._checkProps(_this.props);

    if (_this.props.viewabilityConfigCallbackPairs) {
      _this._virtualizedListPairs = _this.props.viewabilityConfigCallbackPairs.map(function (pair) {
        return {
          viewabilityConfig: pair.viewabilityConfig,
          onViewableItemsChanged: _this._createOnViewableItemsChanged(pair.onViewableItemsChanged)
        };
      });
    } else if (_this.props.onViewableItemsChanged) {
      _this._virtualizedListPairs.push({
        viewabilityConfig: _this.props.viewabilityConfig,
        onViewableItemsChanged: _this._createOnViewableItemsChanged(_this.props.onViewableItemsChanged)
      });
    }

    return _this;
  }

  (0, _createClass2.default)(FlatList, [{
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      invariant(prevProps.numColumns === this.props.numColumns, 'Changing numColumns on the fly is not supported. Change the key prop on FlatList when ' + 'changing the number of columns to force a fresh render of the component.');
      invariant(prevProps.onViewableItemsChanged === this.props.onViewableItemsChanged, 'Changing onViewableItemsChanged on the fly is not supported');
      invariant(!deepDiffer(prevProps.viewabilityConfig, this.props.viewabilityConfig), 'Changing viewabilityConfig on the fly is not supported');
      invariant(prevProps.viewabilityConfigCallbackPairs === this.props.viewabilityConfigCallbackPairs, 'Changing viewabilityConfigCallbackPairs on the fly is not supported');

      this._checkProps(this.props);
    }
  }, {
    key: "_checkProps",
    value: function _checkProps(props) {
      var getItem = props.getItem,
          getItemCount = props.getItemCount,
          horizontal = props.horizontal,
          numColumns = props.numColumns,
          columnWrapperStyle = props.columnWrapperStyle,
          onViewableItemsChanged = props.onViewableItemsChanged,
          viewabilityConfigCallbackPairs = props.viewabilityConfigCallbackPairs;
      invariant(!getItem && !getItemCount, 'FlatList does not support custom data formats.');

      if (numColumns > 1) {
        invariant(!horizontal, 'numColumns does not support horizontal.');
      } else {
        invariant(!columnWrapperStyle, 'columnWrapperStyle not supported for single column lists');
      }

      invariant(!(onViewableItemsChanged && viewabilityConfigCallbackPairs), 'FlatList does not support setting both onViewableItemsChanged and ' + 'viewabilityConfigCallbackPairs.');
    }
  }, {
    key: "_pushMultiColumnViewable",
    value: function _pushMultiColumnViewable(arr, v) {
      var _this$props3 = this.props,
          numColumns = _this$props3.numColumns,
          keyExtractor = _this$props3.keyExtractor;
      v.item.forEach(function (item, ii) {
        invariant(v.index != null, 'Missing index!');
        var index = v.index * numColumns + ii;
        arr.push(_objectSpread({}, v, {
          item: item,
          key: keyExtractor(item, index),
          index: index
        }));
      });
    }
  }, {
    key: "_createOnViewableItemsChanged",
    value: function _createOnViewableItemsChanged(onViewableItemsChanged) {
      var _this2 = this;

      return function (info) {
        var numColumns = _this2.props.numColumns;

        if (onViewableItemsChanged) {
          if (numColumns > 1) {
            var changed = [];
            var viewableItems = [];
            info.viewableItems.forEach(function (v) {
              return _this2._pushMultiColumnViewable(viewableItems, v);
            });
            info.changed.forEach(function (v) {
              return _this2._pushMultiColumnViewable(changed, v);
            });
            onViewableItemsChanged({
              viewableItems: viewableItems,
              changed: changed
            });
          } else {
            onViewableItemsChanged(info);
          }
        }
      };
    }
  }, {
    key: "render",
    value: function render() {
      return React.createElement(VirtualizedList, (0, _extends2.default)({}, this.props, {
        renderItem: this._renderItem,
        getItem: this._getItem,
        getItemCount: this._getItemCount,
        keyExtractor: this._keyExtractor,
        ref: this._captureRef,
        viewabilityConfigCallbackPairs: this._virtualizedListPairs
      }));
    }
  }]);
  return FlatList;
}(React.PureComponent);

FlatList.defaultProps = defaultProps;
var styles = StyleSheet.create({
  row: {
    flexDirection: 'row'
  }
});
module.exports = FlatList;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZsYXRMaXN0LmpzIl0sIm5hbWVzIjpbIlBsYXRmb3JtIiwicmVxdWlyZSIsImRlZXBEaWZmZXIiLCJSZWFjdCIsIlZpZXciLCJWaXJ0dWFsaXplZExpc3QiLCJTdHlsZVNoZWV0IiwiaW52YXJpYW50IiwiZGVmYXVsdFByb3BzIiwibnVtQ29sdW1ucyIsInJlbW92ZUNsaXBwZWRTdWJ2aWV3cyIsIk9TIiwiRmxhdExpc3QiLCJwYXJhbXMiLCJfbGlzdFJlZiIsInNjcm9sbFRvRW5kIiwic2Nyb2xsVG9JbmRleCIsInNjcm9sbFRvSXRlbSIsInNjcm9sbFRvT2Zmc2V0IiwicmVjb3JkSW50ZXJhY3Rpb24iLCJmbGFzaFNjcm9sbEluZGljYXRvcnMiLCJnZXRTY3JvbGxSZXNwb25kZXIiLCJnZXRTY3JvbGxhYmxlTm9kZSIsInByb3BzIiwic2V0TmF0aXZlUHJvcHMiLCJfdmlydHVhbGl6ZWRMaXN0UGFpcnMiLCJfY2FwdHVyZVJlZiIsInJlZiIsIl9nZXRJdGVtIiwiZGF0YSIsImluZGV4IiwicmV0Iiwia2siLCJpdGVtIiwicHVzaCIsIl9nZXRJdGVtQ291bnQiLCJNYXRoIiwiY2VpbCIsImxlbmd0aCIsIl9rZXlFeHRyYWN0b3IiLCJpdGVtcyIsImtleUV4dHJhY3RvciIsIkFycmF5IiwiaXNBcnJheSIsIm1hcCIsIml0Iiwiam9pbiIsIl9yZW5kZXJJdGVtIiwiaW5mbyIsInJlbmRlckl0ZW0iLCJjb2x1bW5XcmFwcGVyU3R5bGUiLCJjb21wb3NlIiwic3R5bGVzIiwicm93IiwiZWxlbWVudCIsInNlcGFyYXRvcnMiLCJjbG9uZUVsZW1lbnQiLCJrZXkiLCJfY2hlY2tQcm9wcyIsInZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycyIsInBhaXIiLCJ2aWV3YWJpbGl0eUNvbmZpZyIsIm9uVmlld2FibGVJdGVtc0NoYW5nZWQiLCJfY3JlYXRlT25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCIsInByZXZQcm9wcyIsImdldEl0ZW0iLCJnZXRJdGVtQ291bnQiLCJob3Jpem9udGFsIiwiYXJyIiwidiIsImZvckVhY2giLCJpaSIsImNoYW5nZWQiLCJ2aWV3YWJsZUl0ZW1zIiwiX3B1c2hNdWx0aUNvbHVtblZpZXdhYmxlIiwiUHVyZUNvbXBvbmVudCIsImNyZWF0ZSIsImZsZXhEaXJlY3Rpb24iLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFTQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBLElBQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBQ0EsSUFBTUMsVUFBVSxHQUFHRCxPQUFPLENBQUMsWUFBRCxDQUExQjs7QUFDQSxJQUFNRSxLQUFLLEdBQUdGLE9BQU8sQ0FBQyxPQUFELENBQXJCOztBQUNBLElBQU1HLElBQUksR0FBR0gsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBQ0EsSUFBTUksZUFBZSxHQUFHSixPQUFPLENBQUMsaUJBQUQsQ0FBL0I7O0FBQ0EsSUFBTUssVUFBVSxHQUFHTCxPQUFPLENBQUMsWUFBRCxDQUExQjs7QUFFQSxJQUFNTSxTQUFTLEdBQUdOLE9BQU8sQ0FBQyxXQUFELENBQXpCOztBQXlNQSxJQUFNTyxZQUFZLHFCQUNiSCxlQUFlLENBQUNHLFlBREg7QUFFaEJDLEVBQUFBLFVBQVUsRUFBRSxDQUZJO0FBUWhCQyxFQUFBQSxxQkFBcUIsRUFBRVYsUUFBUSxDQUFDVyxFQUFULEtBQWdCO0FBUnZCLEVBQWxCOztJQXdITUMsUTs7OztnQ0FNUUMsTSxFQUFpQztBQUMzQyxVQUFJLEtBQUtDLFFBQVQsRUFBbUI7QUFDakIsYUFBS0EsUUFBTCxDQUFjQyxXQUFkLENBQTBCRixNQUExQjtBQUNEO0FBQ0Y7OztrQ0FVYUEsTSxFQUtYO0FBQ0QsVUFBSSxLQUFLQyxRQUFULEVBQW1CO0FBQ2pCLGFBQUtBLFFBQUwsQ0FBY0UsYUFBZCxDQUE0QkgsTUFBNUI7QUFDRDtBQUNGOzs7aUNBUVlBLE0sRUFJVjtBQUNELFVBQUksS0FBS0MsUUFBVCxFQUFtQjtBQUNqQixhQUFLQSxRQUFMLENBQWNHLFlBQWQs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QUFBQSxhQUFhLEVBQWJBLGFBQUQ7QUFBZ0JELGNBQUFBLE9BQU8sRUFBUEE7QUFBaEIsYUFBRCxDQUF0QjtBQUNELFdBUkQsTUFRTztBQUNMVixZQUFBQSxzQkFBc0IsQ0FBQ2QsSUFBRCxDQUF0QjtBQUNEO0FBQ0Y7QUFDRixPQWxCRDtBQW1CRDs7OzZCQStCUTtBQUNQLGFBQ0Usb0JBQUMsZUFBRCw2QkFDTSxLQUFLekIsS0FEWDtBQUVFLFFBQUEsVUFBVSxFQUFFLEtBQUt3QixXQUZuQjtBQUdFLFFBQUEsT0FBTyxFQUFFLEtBQUtuQixRQUhoQjtBQUlFLFFBQUEsWUFBWSxFQUFFLEtBQUtPLGFBSnJCO0FBS0UsUUFBQSxZQUFZLEVBQUUsS0FBS0ksYUFMckI7QUFNRSxRQUFBLEdBQUcsRUFBRSxLQUFLYixXQU5aO0FBT0UsUUFBQSw4QkFBOEIsRUFBRSxLQUFLRDtBQVB2QyxTQURGO0FBV0Q7OztFQTlTMkJ0QixLQUFLLENBQUN3RSxhOztBQUE5Qi9ELFEsQ0FDR0osWSxHQUE2QkEsWTtBQWdUdEMsSUFBTTRDLE1BQU0sR0FBRzlDLFVBQVUsQ0FBQ3NFLE1BQVgsQ0FBa0I7QUFDL0J2QixFQUFBQSxHQUFHLEVBQUU7QUFBQ3dCLElBQUFBLGFBQWEsRUFBRTtBQUFoQjtBQUQwQixDQUFsQixDQUFmO0FBSUFDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQm5FLFFBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvd1xuICogQGZvcm1hdFxuICovXG4ndXNlIHN0cmljdCc7XG5cbmNvbnN0IFBsYXRmb3JtID0gcmVxdWlyZSgnUGxhdGZvcm0nKTtcbmNvbnN0IGRlZXBEaWZmZXIgPSByZXF1aXJlKCdkZWVwRGlmZmVyJyk7XG5jb25zdCBSZWFjdCA9IHJlcXVpcmUoJ1JlYWN0Jyk7XG5jb25zdCBWaWV3ID0gcmVxdWlyZSgnVmlldycpO1xuY29uc3QgVmlydHVhbGl6ZWRMaXN0ID0gcmVxdWlyZSgnVmlydHVhbGl6ZWRMaXN0Jyk7XG5jb25zdCBTdHlsZVNoZWV0ID0gcmVxdWlyZSgnU3R5bGVTaGVldCcpO1xuXG5jb25zdCBpbnZhcmlhbnQgPSByZXF1aXJlKCdpbnZhcmlhbnQnKTtcblxuaW1wb3J0IHR5cGUge1ZpZXdTdHlsZVByb3B9IGZyb20gJ1N0eWxlU2hlZXQnO1xuaW1wb3J0IHR5cGUge1xuICBWaWV3YWJpbGl0eUNvbmZpZyxcbiAgVmlld1Rva2VuLFxuICBWaWV3YWJpbGl0eUNvbmZpZ0NhbGxiYWNrUGFpcixcbn0gZnJvbSAnVmlld2FiaWxpdHlIZWxwZXInO1xuaW1wb3J0IHR5cGUge1Byb3BzIGFzIFZpcnR1YWxpemVkTGlzdFByb3BzfSBmcm9tICdWaXJ0dWFsaXplZExpc3QnO1xuXG5leHBvcnQgdHlwZSBTZXBhcmF0b3JzT2JqID0ge1xuICBoaWdobGlnaHQ6ICgpID0+IHZvaWQsXG4gIHVuaGlnaGxpZ2h0OiAoKSA9PiB2b2lkLFxuICB1cGRhdGVQcm9wczogKHNlbGVjdDogJ2xlYWRpbmcnIHwgJ3RyYWlsaW5nJywgbmV3UHJvcHM6IE9iamVjdCkgPT4gdm9pZCxcbn07XG5cbnR5cGUgUmVxdWlyZWRQcm9wczxJdGVtVD4gPSB7XG4gIC8qKlxuICAgKiBUYWtlcyBhbiBpdGVtIGZyb20gYGRhdGFgIGFuZCByZW5kZXJzIGl0IGludG8gdGhlIGxpc3QuIEV4YW1wbGUgdXNhZ2U6XG4gICAqXG4gICAqICAgICA8RmxhdExpc3RcbiAgICogICAgICAgSXRlbVNlcGFyYXRvckNvbXBvbmVudD17UGxhdGZvcm0uT1MgIT09ICdhbmRyb2lkJyAmJiAoe2hpZ2hsaWdodGVkfSkgPT4gKFxuICAgKiAgICAgICAgIDxWaWV3IHN0eWxlPXtbc3R5bGUuc2VwYXJhdG9yLCBoaWdobGlnaHRlZCAmJiB7bWFyZ2luTGVmdDogMH1dfSAvPlxuICAgKiAgICAgICApfVxuICAgKiAgICAgICBkYXRhPXtbe3RpdGxlOiAnVGl0bGUgVGV4dCcsIGtleTogJ2l0ZW0xJ31dfVxuICAgKiAgICAgICByZW5kZXJJdGVtPXsoe2l0ZW0sIHNlcGFyYXRvcnN9KSA9PiAoXG4gICAqICAgICAgICAgPFRvdWNoYWJsZUhpZ2hsaWdodFxuICAgKiAgICAgICAgICAgb25QcmVzcz17KCkgPT4gdGhpcy5fb25QcmVzcyhpdGVtKX1cbiAgICogICAgICAgICAgIG9uU2hvd1VuZGVybGF5PXtzZXBhcmF0b3JzLmhpZ2hsaWdodH1cbiAgICogICAgICAgICAgIG9uSGlkZVVuZGVybGF5PXtzZXBhcmF0b3JzLnVuaGlnaGxpZ2h0fT5cbiAgICogICAgICAgICAgIDxWaWV3IHN0eWxlPXt7YmFja2dyb3VuZENvbG9yOiAnd2hpdGUnfX0+XG4gICAqICAgICAgICAgICAgIDxUZXh0PntpdGVtLnRpdGxlfTwvVGV4dD5cbiAgICogICAgICAgICAgIDwvVmlldz5cbiAgICogICAgICAgICA8L1RvdWNoYWJsZUhpZ2hsaWdodD5cbiAgICogICAgICAgKX1cbiAgICogICAgIC8+XG4gICAqXG4gICAqIFByb3ZpZGVzIGFkZGl0aW9uYWwgbWV0YWRhdGEgbGlrZSBgaW5kZXhgIGlmIHlvdSBuZWVkIGl0LCBhcyB3ZWxsIGFzIGEgbW9yZSBnZW5lcmljXG4gICAqIGBzZXBhcmF0b3JzLnVwZGF0ZVByb3BzYCBmdW5jdGlvbiB3aGljaCBsZXQncyB5b3Ugc2V0IHdoYXRldmVyIHByb3BzIHlvdSB3YW50IHRvIGNoYW5nZSB0aGVcbiAgICogcmVuZGVyaW5nIG9mIGVpdGhlciB0aGUgbGVhZGluZyBzZXBhcmF0b3Igb3IgdHJhaWxpbmcgc2VwYXJhdG9yIGluIGNhc2UgdGhlIG1vcmUgY29tbW9uXG4gICAqIGBoaWdobGlnaHRgIGFuZCBgdW5oaWdobGlnaHRgICh3aGljaCBzZXQgdGhlIGBoaWdobGlnaHRlZDogYm9vbGVhbmAgcHJvcCkgYXJlIGluc3VmZmljaWVudCBmb3JcbiAgICogeW91ciB1c2UtY2FzZS5cbiAgICovXG4gIHJlbmRlckl0ZW06IChpbmZvOiB7XG4gICAgaXRlbTogSXRlbVQsXG4gICAgaW5kZXg6IG51bWJlcixcbiAgICBzZXBhcmF0b3JzOiBTZXBhcmF0b3JzT2JqLFxuICB9KSA9PiA/UmVhY3QuRWxlbWVudDxhbnk+LFxuICAvKipcbiAgICogRm9yIHNpbXBsaWNpdHksIGRhdGEgaXMganVzdCBhIHBsYWluIGFycmF5LiBJZiB5b3Ugd2FudCB0byB1c2Ugc29tZXRoaW5nIGVsc2UsIGxpa2UgYW5cbiAgICogaW1tdXRhYmxlIGxpc3QsIHVzZSB0aGUgdW5kZXJseWluZyBgVmlydHVhbGl6ZWRMaXN0YCBkaXJlY3RseS5cbiAgICovXG4gIGRhdGE6ID8kUmVhZE9ubHlBcnJheTxJdGVtVD4sXG59O1xudHlwZSBPcHRpb25hbFByb3BzPEl0ZW1UPiA9IHtcbiAgLyoqXG4gICAqIFJlbmRlcmVkIGluIGJldHdlZW4gZWFjaCBpdGVtLCBidXQgbm90IGF0IHRoZSB0b3Agb3IgYm90dG9tLiBCeSBkZWZhdWx0LCBgaGlnaGxpZ2h0ZWRgIGFuZFxuICAgKiBgbGVhZGluZ0l0ZW1gIHByb3BzIGFyZSBwcm92aWRlZC4gYHJlbmRlckl0ZW1gIHByb3ZpZGVzIGBzZXBhcmF0b3JzLmhpZ2hsaWdodGAvYHVuaGlnaGxpZ2h0YFxuICAgKiB3aGljaCB3aWxsIHVwZGF0ZSB0aGUgYGhpZ2hsaWdodGVkYCBwcm9wLCBidXQgeW91IGNhbiBhbHNvIGFkZCBjdXN0b20gcHJvcHMgd2l0aFxuICAgKiBgc2VwYXJhdG9ycy51cGRhdGVQcm9wc2AuXG4gICAqL1xuICBJdGVtU2VwYXJhdG9yQ29tcG9uZW50PzogP1JlYWN0LkNvbXBvbmVudFR5cGU8YW55PixcbiAgLyoqXG4gICAqIFJlbmRlcmVkIHdoZW4gdGhlIGxpc3QgaXMgZW1wdHkuIENhbiBiZSBhIFJlYWN0IENvbXBvbmVudCBDbGFzcywgYSByZW5kZXIgZnVuY3Rpb24sIG9yXG4gICAqIGEgcmVuZGVyZWQgZWxlbWVudC5cbiAgICovXG4gIExpc3RFbXB0eUNvbXBvbmVudD86ID8oUmVhY3QuQ29tcG9uZW50VHlwZTxhbnk+IHwgUmVhY3QuRWxlbWVudDxhbnk+KSxcbiAgLyoqXG4gICAqIFJlbmRlcmVkIGF0IHRoZSBib3R0b20gb2YgYWxsIHRoZSBpdGVtcy4gQ2FuIGJlIGEgUmVhY3QgQ29tcG9uZW50IENsYXNzLCBhIHJlbmRlciBmdW5jdGlvbiwgb3JcbiAgICogYSByZW5kZXJlZCBlbGVtZW50LlxuICAgKi9cbiAgTGlzdEZvb3RlckNvbXBvbmVudD86ID8oUmVhY3QuQ29tcG9uZW50VHlwZTxhbnk+IHwgUmVhY3QuRWxlbWVudDxhbnk+KSxcbiAgLyoqXG4gICAqIFN0eWxpbmcgZm9yIGludGVybmFsIFZpZXcgZm9yIExpc3RGb290ZXJDb21wb25lbnRcbiAgICovXG4gIExpc3RGb290ZXJDb21wb25lbnRTdHlsZT86IFZpZXdTdHlsZVByb3AsXG4gIC8qKlxuICAgKiBSZW5kZXJlZCBhdCB0aGUgdG9wIG9mIGFsbCB0aGUgaXRlbXMuIENhbiBiZSBhIFJlYWN0IENvbXBvbmVudCBDbGFzcywgYSByZW5kZXIgZnVuY3Rpb24sIG9yXG4gICAqIGEgcmVuZGVyZWQgZWxlbWVudC5cbiAgICovXG4gIExpc3RIZWFkZXJDb21wb25lbnQ/OiA/KFJlYWN0LkNvbXBvbmVudFR5cGU8YW55PiB8IFJlYWN0LkVsZW1lbnQ8YW55PiksXG4gIC8qKlxuICAgKiBTdHlsaW5nIGZvciBpbnRlcm5hbCBWaWV3IGZvciBMaXN0SGVhZGVyQ29tcG9uZW50XG4gICAqL1xuICBMaXN0SGVhZGVyQ29tcG9uZW50U3R5bGU/OiBWaWV3U3R5bGVQcm9wLFxuICAvKipcbiAgICogT3B0aW9uYWwgY3VzdG9tIHN0eWxlIGZvciBtdWx0aS1pdGVtIHJvd3MgZ2VuZXJhdGVkIHdoZW4gbnVtQ29sdW1ucyA+IDEuXG4gICAqL1xuICBjb2x1bW5XcmFwcGVyU3R5bGU/OiBWaWV3U3R5bGVQcm9wLFxuICAvKipcbiAgICogQSBtYXJrZXIgcHJvcGVydHkgZm9yIHRlbGxpbmcgdGhlIGxpc3QgdG8gcmUtcmVuZGVyIChzaW5jZSBpdCBpbXBsZW1lbnRzIGBQdXJlQ29tcG9uZW50YCkuIElmXG4gICAqIGFueSBvZiB5b3VyIGByZW5kZXJJdGVtYCwgSGVhZGVyLCBGb290ZXIsIGV0Yy4gZnVuY3Rpb25zIGRlcGVuZCBvbiBhbnl0aGluZyBvdXRzaWRlIG9mIHRoZVxuICAgKiBgZGF0YWAgcHJvcCwgc3RpY2sgaXQgaGVyZSBhbmQgdHJlYXQgaXQgaW1tdXRhYmx5LlxuICAgKi9cbiAgZXh0cmFEYXRhPzogYW55LFxuICAvKipcbiAgICogYGdldEl0ZW1MYXlvdXRgIGlzIGFuIG9wdGlvbmFsIG9wdGltaXphdGlvbnMgdGhhdCBsZXQgdXMgc2tpcCBtZWFzdXJlbWVudCBvZiBkeW5hbWljIGNvbnRlbnQgaWZcbiAgICogeW91IGtub3cgdGhlIGhlaWdodCBvZiBpdGVtcyBhIHByaW9yaS4gYGdldEl0ZW1MYXlvdXRgIGlzIHRoZSBtb3N0IGVmZmljaWVudCwgYW5kIGlzIGVhc3kgdG9cbiAgICogdXNlIGlmIHlvdSBoYXZlIGZpeGVkIGhlaWdodCBpdGVtcywgZm9yIGV4YW1wbGU6XG4gICAqXG4gICAqICAgICBnZXRJdGVtTGF5b3V0PXsoZGF0YSwgaW5kZXgpID0+IChcbiAgICogICAgICAge2xlbmd0aDogSVRFTV9IRUlHSFQsIG9mZnNldDogSVRFTV9IRUlHSFQgKiBpbmRleCwgaW5kZXh9XG4gICAqICAgICApfVxuICAgKlxuICAgKiBBZGRpbmcgYGdldEl0ZW1MYXlvdXRgIGNhbiBiZSBhIGdyZWF0IHBlcmZvcm1hbmNlIGJvb3N0IGZvciBsaXN0cyBvZiBzZXZlcmFsIGh1bmRyZWQgaXRlbXMuXG4gICAqIFJlbWVtYmVyIHRvIGluY2x1ZGUgc2VwYXJhdG9yIGxlbmd0aCAoaGVpZ2h0IG9yIHdpZHRoKSBpbiB5b3VyIG9mZnNldCBjYWxjdWxhdGlvbiBpZiB5b3VcbiAgICogc3BlY2lmeSBgSXRlbVNlcGFyYXRvckNvbXBvbmVudGAuXG4gICAqL1xuICBnZXRJdGVtTGF5b3V0PzogKFxuICAgIGRhdGE6ID9BcnJheTxJdGVtVD4sXG4gICAgaW5kZXg6IG51bWJlcixcbiAgKSA9PiB7bGVuZ3RoOiBudW1iZXIsIG9mZnNldDogbnVtYmVyLCBpbmRleDogbnVtYmVyfSxcbiAgLyoqXG4gICAqIElmIHRydWUsIHJlbmRlcnMgaXRlbXMgbmV4dCB0byBlYWNoIG90aGVyIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHN0YWNrZWQgdmVydGljYWxseS5cbiAgICovXG4gIGhvcml6b250YWw/OiA/Ym9vbGVhbixcbiAgLyoqXG4gICAqIEhvdyBtYW55IGl0ZW1zIHRvIHJlbmRlciBpbiB0aGUgaW5pdGlhbCBiYXRjaC4gVGhpcyBzaG91bGQgYmUgZW5vdWdoIHRvIGZpbGwgdGhlIHNjcmVlbiBidXQgbm90XG4gICAqIG11Y2ggbW9yZS4gTm90ZSB0aGVzZSBpdGVtcyB3aWxsIG5ldmVyIGJlIHVubW91bnRlZCBhcyBwYXJ0IG9mIHRoZSB3aW5kb3dlZCByZW5kZXJpbmcgaW4gb3JkZXJcbiAgICogdG8gaW1wcm92ZSBwZXJjZWl2ZWQgcGVyZm9ybWFuY2Ugb2Ygc2Nyb2xsLXRvLXRvcCBhY3Rpb25zLlxuICAgKi9cbiAgaW5pdGlhbE51bVRvUmVuZGVyOiBudW1iZXIsXG4gIC8qKlxuICAgKiBJbnN0ZWFkIG9mIHN0YXJ0aW5nIGF0IHRoZSB0b3Agd2l0aCB0aGUgZmlyc3QgaXRlbSwgc3RhcnQgYXQgYGluaXRpYWxTY3JvbGxJbmRleGAuIFRoaXNcbiAgICogZGlzYWJsZXMgdGhlIFwic2Nyb2xsIHRvIHRvcFwiIG9wdGltaXphdGlvbiB0aGF0IGtlZXBzIHRoZSBmaXJzdCBgaW5pdGlhbE51bVRvUmVuZGVyYCBpdGVtc1xuICAgKiBhbHdheXMgcmVuZGVyZWQgYW5kIGltbWVkaWF0ZWx5IHJlbmRlcnMgdGhlIGl0ZW1zIHN0YXJ0aW5nIGF0IHRoaXMgaW5pdGlhbCBpbmRleC4gUmVxdWlyZXNcbiAgICogYGdldEl0ZW1MYXlvdXRgIHRvIGJlIGltcGxlbWVudGVkLlxuICAgKi9cbiAgaW5pdGlhbFNjcm9sbEluZGV4PzogP251bWJlcixcbiAgLyoqXG4gICAqIFJldmVyc2VzIHRoZSBkaXJlY3Rpb24gb2Ygc2Nyb2xsLiBVc2VzIHNjYWxlIHRyYW5zZm9ybXMgb2YgLTEuXG4gICAqL1xuICBpbnZlcnRlZD86ID9ib29sZWFuLFxuICAvKipcbiAgICogVXNlZCB0byBleHRyYWN0IGEgdW5pcXVlIGtleSBmb3IgYSBnaXZlbiBpdGVtIGF0IHRoZSBzcGVjaWZpZWQgaW5kZXguIEtleSBpcyB1c2VkIGZvciBjYWNoaW5nXG4gICAqIGFuZCBhcyB0aGUgcmVhY3Qga2V5IHRvIHRyYWNrIGl0ZW0gcmUtb3JkZXJpbmcuIFRoZSBkZWZhdWx0IGV4dHJhY3RvciBjaGVja3MgYGl0ZW0ua2V5YCwgdGhlblxuICAgKiBmYWxscyBiYWNrIHRvIHVzaW5nIHRoZSBpbmRleCwgbGlrZSBSZWFjdCBkb2VzLlxuICAgKi9cbiAga2V5RXh0cmFjdG9yOiAoaXRlbTogSXRlbVQsIGluZGV4OiBudW1iZXIpID0+IHN0cmluZyxcbiAgLyoqXG4gICAqIE11bHRpcGxlIGNvbHVtbnMgY2FuIG9ubHkgYmUgcmVuZGVyZWQgd2l0aCBgaG9yaXpvbnRhbD17ZmFsc2V9YCBhbmQgd2lsbCB6aWctemFnIGxpa2UgYVxuICAgKiBgZmxleFdyYXBgIGxheW91dC4gSXRlbXMgc2hvdWxkIGFsbCBiZSB0aGUgc2FtZSBoZWlnaHQgLSBtYXNvbnJ5IGxheW91dHMgYXJlIG5vdCBzdXBwb3J0ZWQuXG4gICAqL1xuICBudW1Db2x1bW5zOiBudW1iZXIsXG4gIC8qKlxuICAgKiBDYWxsZWQgb25jZSB3aGVuIHRoZSBzY3JvbGwgcG9zaXRpb24gZ2V0cyB3aXRoaW4gYG9uRW5kUmVhY2hlZFRocmVzaG9sZGAgb2YgdGhlIHJlbmRlcmVkXG4gICAqIGNvbnRlbnQuXG4gICAqL1xuICBvbkVuZFJlYWNoZWQ/OiA/KGluZm86IHtkaXN0YW5jZUZyb21FbmQ6IG51bWJlcn0pID0+IHZvaWQsXG4gIC8qKlxuICAgKiBIb3cgZmFyIGZyb20gdGhlIGVuZCAoaW4gdW5pdHMgb2YgdmlzaWJsZSBsZW5ndGggb2YgdGhlIGxpc3QpIHRoZSBib3R0b20gZWRnZSBvZiB0aGVcbiAgICogbGlzdCBtdXN0IGJlIGZyb20gdGhlIGVuZCBvZiB0aGUgY29udGVudCB0byB0cmlnZ2VyIHRoZSBgb25FbmRSZWFjaGVkYCBjYWxsYmFjay5cbiAgICogVGh1cyBhIHZhbHVlIG9mIDAuNSB3aWxsIHRyaWdnZXIgYG9uRW5kUmVhY2hlZGAgd2hlbiB0aGUgZW5kIG9mIHRoZSBjb250ZW50IGlzXG4gICAqIHdpdGhpbiBoYWxmIHRoZSB2aXNpYmxlIGxlbmd0aCBvZiB0aGUgbGlzdC5cbiAgICovXG4gIG9uRW5kUmVhY2hlZFRocmVzaG9sZD86ID9udW1iZXIsXG4gIC8qKlxuICAgKiBJZiBwcm92aWRlZCwgYSBzdGFuZGFyZCBSZWZyZXNoQ29udHJvbCB3aWxsIGJlIGFkZGVkIGZvciBcIlB1bGwgdG8gUmVmcmVzaFwiIGZ1bmN0aW9uYWxpdHkuIE1ha2VcbiAgICogc3VyZSB0byBhbHNvIHNldCB0aGUgYHJlZnJlc2hpbmdgIHByb3AgY29ycmVjdGx5LlxuICAgKi9cbiAgb25SZWZyZXNoPzogPygpID0+IHZvaWQsXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiB0aGUgdmlld2FiaWxpdHkgb2Ygcm93cyBjaGFuZ2VzLCBhcyBkZWZpbmVkIGJ5IHRoZSBgdmlld2FiaWxpdHlDb25maWdgIHByb3AuXG4gICAqL1xuICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkPzogPyhpbmZvOiB7XG4gICAgdmlld2FibGVJdGVtczogQXJyYXk8Vmlld1Rva2VuPixcbiAgICBjaGFuZ2VkOiBBcnJheTxWaWV3VG9rZW4+LFxuICB9KSA9PiB2b2lkLFxuICAvKipcbiAgICogU2V0IHRoaXMgd2hlbiBvZmZzZXQgaXMgbmVlZGVkIGZvciB0aGUgbG9hZGluZyBpbmRpY2F0b3IgdG8gc2hvdyBjb3JyZWN0bHkuXG4gICAqIEBwbGF0Zm9ybSBhbmRyb2lkXG4gICAqL1xuICBwcm9ncmVzc1ZpZXdPZmZzZXQ/OiBudW1iZXIsXG4gIC8qKlxuICAgKiBUaGUgbGVnYWN5IGltcGxlbWVudGF0aW9uIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQuXG4gICAqL1xuICBsZWdhY3lJbXBsZW1lbnRhdGlvbj86IGVtcHR5LFxuICAvKipcbiAgICogU2V0IHRoaXMgdHJ1ZSB3aGlsZSB3YWl0aW5nIGZvciBuZXcgZGF0YSBmcm9tIGEgcmVmcmVzaC5cbiAgICovXG4gIHJlZnJlc2hpbmc/OiA/Ym9vbGVhbixcbiAgLyoqXG4gICAqIE5vdGU6IG1heSBoYXZlIGJ1Z3MgKG1pc3NpbmcgY29udGVudCkgaW4gc29tZSBjaXJjdW1zdGFuY2VzIC0gdXNlIGF0IHlvdXIgb3duIHJpc2suXG4gICAqXG4gICAqIFRoaXMgbWF5IGltcHJvdmUgc2Nyb2xsIHBlcmZvcm1hbmNlIGZvciBsYXJnZSBsaXN0cy5cbiAgICovXG4gIHJlbW92ZUNsaXBwZWRTdWJ2aWV3cz86IGJvb2xlYW4sXG4gIC8qKlxuICAgKiBTZWUgYFZpZXdhYmlsaXR5SGVscGVyYCBmb3IgZmxvdyB0eXBlIGFuZCBmdXJ0aGVyIGRvY3VtZW50YXRpb24uXG4gICAqL1xuICB2aWV3YWJpbGl0eUNvbmZpZz86IFZpZXdhYmlsaXR5Q29uZmlnLFxuICAvKipcbiAgICogTGlzdCBvZiBWaWV3YWJpbGl0eUNvbmZpZy9vblZpZXdhYmxlSXRlbXNDaGFuZ2VkIHBhaXJzLiBBIHNwZWNpZmljIG9uVmlld2FibGVJdGVtc0NoYW5nZWRcbiAgICogd2lsbCBiZSBjYWxsZWQgd2hlbiBpdHMgY29ycmVzcG9uZGluZyBWaWV3YWJpbGl0eUNvbmZpZydzIGNvbmRpdGlvbnMgYXJlIG1ldC5cbiAgICovXG4gIHZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycz86IEFycmF5PFZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlyPixcbn07XG5leHBvcnQgdHlwZSBQcm9wczxJdGVtVD4gPSBSZXF1aXJlZFByb3BzPEl0ZW1UPiAmXG4gIE9wdGlvbmFsUHJvcHM8SXRlbVQ+ICZcbiAgVmlydHVhbGl6ZWRMaXN0UHJvcHM7XG5cbmNvbnN0IGRlZmF1bHRQcm9wcyA9IHtcbiAgLi4uVmlydHVhbGl6ZWRMaXN0LmRlZmF1bHRQcm9wcyxcbiAgbnVtQ29sdW1uczogMSxcbiAgLyoqXG4gICAqIEVuYWJsaW5nIHRoaXMgcHJvcCBvbiBBbmRyb2lkIGdyZWF0bHkgaW1wcm92ZXMgc2Nyb2xsaW5nIHBlcmZvcm1hbmNlIHdpdGggbm8ga25vd24gaXNzdWVzLlxuICAgKiBUaGUgYWx0ZXJuYXRpdmUgaXMgdGhhdCBzY3JvbGxpbmcgb24gQW5kcm9pZCBpcyB1bnVzYWJseSBiYWQuIEVuYWJsaW5nIGl0IG9uIGlPUyBoYXMgYSBmZXdcbiAgICoga25vd24gaXNzdWVzLlxuICAgKi9cbiAgcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzOiBQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnLFxufTtcbmV4cG9ydCB0eXBlIERlZmF1bHRQcm9wcyA9IHR5cGVvZiBkZWZhdWx0UHJvcHM7XG5cbi8qKlxuICogQSBwZXJmb3JtYW50IGludGVyZmFjZSBmb3IgcmVuZGVyaW5nIHNpbXBsZSwgZmxhdCBsaXN0cywgc3VwcG9ydGluZyB0aGUgbW9zdCBoYW5keSBmZWF0dXJlczpcbiAqXG4gKiAgLSBGdWxseSBjcm9zcy1wbGF0Zm9ybS5cbiAqICAtIE9wdGlvbmFsIGhvcml6b250YWwgbW9kZS5cbiAqICAtIENvbmZpZ3VyYWJsZSB2aWV3YWJpbGl0eSBjYWxsYmFja3MuXG4gKiAgLSBIZWFkZXIgc3VwcG9ydC5cbiAqICAtIEZvb3RlciBzdXBwb3J0LlxuICogIC0gU2VwYXJhdG9yIHN1cHBvcnQuXG4gKiAgLSBQdWxsIHRvIFJlZnJlc2guXG4gKiAgLSBTY3JvbGwgbG9hZGluZy5cbiAqICAtIFNjcm9sbFRvSW5kZXggc3VwcG9ydC5cbiAqXG4gKiBJZiB5b3UgbmVlZCBzZWN0aW9uIHN1cHBvcnQsIHVzZSBbYDxTZWN0aW9uTGlzdD5gXShkb2NzL3NlY3Rpb25saXN0Lmh0bWwpLlxuICpcbiAqIE1pbmltYWwgRXhhbXBsZTpcbiAqXG4gKiAgICAgPEZsYXRMaXN0XG4gKiAgICAgICBkYXRhPXtbe2tleTogJ2EnfSwge2tleTogJ2InfV19XG4gKiAgICAgICByZW5kZXJJdGVtPXsoe2l0ZW19KSA9PiA8VGV4dD57aXRlbS5rZXl9PC9UZXh0Pn1cbiAqICAgICAvPlxuICpcbiAqIE1vcmUgY29tcGxleCwgbXVsdGktc2VsZWN0IGV4YW1wbGUgZGVtb25zdHJhdGluZyBgUHVyZUNvbXBvbmVudGAgdXNhZ2UgZm9yIHBlcmYgb3B0aW1pemF0aW9uIGFuZCBhdm9pZGluZyBidWdzLlxuICpcbiAqIC0gQnkgYmluZGluZyB0aGUgYG9uUHJlc3NJdGVtYCBoYW5kbGVyLCB0aGUgcHJvcHMgd2lsbCByZW1haW4gYD09PWAgYW5kIGBQdXJlQ29tcG9uZW50YCB3aWxsXG4gKiAgIHByZXZlbnQgd2FzdGVmdWwgcmUtcmVuZGVycyB1bmxlc3MgdGhlIGFjdHVhbCBgaWRgLCBgc2VsZWN0ZWRgLCBvciBgdGl0bGVgIHByb3BzIGNoYW5nZSwgZXZlblxuICogICBpZiB0aGUgY29tcG9uZW50cyByZW5kZXJlZCBpbiBgTXlMaXN0SXRlbWAgZGlkIG5vdCBoYXZlIHN1Y2ggb3B0aW1pemF0aW9ucy5cbiAqIC0gQnkgcGFzc2luZyBgZXh0cmFEYXRhPXt0aGlzLnN0YXRlfWAgdG8gYEZsYXRMaXN0YCB3ZSBtYWtlIHN1cmUgYEZsYXRMaXN0YCBpdHNlbGYgd2lsbCByZS1yZW5kZXJcbiAqICAgd2hlbiB0aGUgYHN0YXRlLnNlbGVjdGVkYCBjaGFuZ2VzLiBXaXRob3V0IHNldHRpbmcgdGhpcyBwcm9wLCBgRmxhdExpc3RgIHdvdWxkIG5vdCBrbm93IGl0XG4gKiAgIG5lZWRzIHRvIHJlLXJlbmRlciBhbnkgaXRlbXMgYmVjYXVzZSBpdCBpcyBhbHNvIGEgYFB1cmVDb21wb25lbnRgIGFuZCB0aGUgcHJvcCBjb21wYXJpc29uIHdpbGxcbiAqICAgbm90IHNob3cgYW55IGNoYW5nZXMuXG4gKiAtIGBrZXlFeHRyYWN0b3JgIHRlbGxzIHRoZSBsaXN0IHRvIHVzZSB0aGUgYGlkYHMgZm9yIHRoZSByZWFjdCBrZXlzIGluc3RlYWQgb2YgdGhlIGRlZmF1bHQgYGtleWAgcHJvcGVydHkuXG4gKlxuICpcbiAqICAgICBjbGFzcyBNeUxpc3RJdGVtIGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudCB7XG4gKiAgICAgICBfb25QcmVzcyA9ICgpID0+IHtcbiAqICAgICAgICAgdGhpcy5wcm9wcy5vblByZXNzSXRlbSh0aGlzLnByb3BzLmlkKTtcbiAqICAgICAgIH07XG4gKlxuICogICAgICAgcmVuZGVyKCkge1xuICogICAgICAgICBjb25zdCB0ZXh0Q29sb3IgPSB0aGlzLnByb3BzLnNlbGVjdGVkID8gXCJyZWRcIiA6IFwiYmxhY2tcIjtcbiAqICAgICAgICAgcmV0dXJuIChcbiAqICAgICAgICAgICA8VG91Y2hhYmxlT3BhY2l0eSBvblByZXNzPXt0aGlzLl9vblByZXNzfT5cbiAqICAgICAgICAgICAgIDxWaWV3PlxuICogICAgICAgICAgICAgICA8VGV4dCBzdHlsZT17eyBjb2xvcjogdGV4dENvbG9yIH19PlxuICogICAgICAgICAgICAgICAgIHt0aGlzLnByb3BzLnRpdGxlfVxuICogICAgICAgICAgICAgICA8L1RleHQ+XG4gKiAgICAgICAgICAgICA8L1ZpZXc+XG4gKiAgICAgICAgICAgPC9Ub3VjaGFibGVPcGFjaXR5PlxuICogICAgICAgICApO1xuICogICAgICAgfVxuICogICAgIH1cbiAqXG4gKiAgICAgY2xhc3MgTXVsdGlTZWxlY3RMaXN0IGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudCB7XG4gKiAgICAgICBzdGF0ZSA9IHtzZWxlY3RlZDogKG5ldyBNYXAoKTogTWFwPHN0cmluZywgYm9vbGVhbj4pfTtcbiAqXG4gKiAgICAgICBfa2V5RXh0cmFjdG9yID0gKGl0ZW0sIGluZGV4KSA9PiBpdGVtLmlkO1xuICpcbiAqICAgICAgIF9vblByZXNzSXRlbSA9IChpZDogc3RyaW5nKSA9PiB7XG4gKiAgICAgICAgIC8vIHVwZGF0ZXIgZnVuY3Rpb25zIGFyZSBwcmVmZXJyZWQgZm9yIHRyYW5zYWN0aW9uYWwgdXBkYXRlc1xuICogICAgICAgICB0aGlzLnNldFN0YXRlKChzdGF0ZSkgPT4ge1xuICogICAgICAgICAgIC8vIGNvcHkgdGhlIG1hcCByYXRoZXIgdGhhbiBtb2RpZnlpbmcgc3RhdGUuXG4gKiAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBuZXcgTWFwKHN0YXRlLnNlbGVjdGVkKTtcbiAqICAgICAgICAgICBzZWxlY3RlZC5zZXQoaWQsICFzZWxlY3RlZC5nZXQoaWQpKTsgLy8gdG9nZ2xlXG4gKiAgICAgICAgICAgcmV0dXJuIHtzZWxlY3RlZH07XG4gKiAgICAgICAgIH0pO1xuICogICAgICAgfTtcbiAqXG4gKiAgICAgICBfcmVuZGVySXRlbSA9ICh7aXRlbX0pID0+IChcbiAqICAgICAgICAgPE15TGlzdEl0ZW1cbiAqICAgICAgICAgICBpZD17aXRlbS5pZH1cbiAqICAgICAgICAgICBvblByZXNzSXRlbT17dGhpcy5fb25QcmVzc0l0ZW19XG4gKiAgICAgICAgICAgc2VsZWN0ZWQ9eyEhdGhpcy5zdGF0ZS5zZWxlY3RlZC5nZXQoaXRlbS5pZCl9XG4gKiAgICAgICAgICAgdGl0bGU9e2l0ZW0udGl0bGV9XG4gKiAgICAgICAgIC8+XG4gKiAgICAgICApO1xuICpcbiAqICAgICAgIHJlbmRlcigpIHtcbiAqICAgICAgICAgcmV0dXJuIChcbiAqICAgICAgICAgICA8RmxhdExpc3RcbiAqICAgICAgICAgICAgIGRhdGE9e3RoaXMucHJvcHMuZGF0YX1cbiAqICAgICAgICAgICAgIGV4dHJhRGF0YT17dGhpcy5zdGF0ZX1cbiAqICAgICAgICAgICAgIGtleUV4dHJhY3Rvcj17dGhpcy5fa2V5RXh0cmFjdG9yfVxuICogICAgICAgICAgICAgcmVuZGVySXRlbT17dGhpcy5fcmVuZGVySXRlbX1cbiAqICAgICAgICAgICAvPlxuICogICAgICAgICApO1xuICogICAgICAgfVxuICogICAgIH1cbiAqXG4gKiBUaGlzIGlzIGEgY29udmVuaWVuY2Ugd3JhcHBlciBhcm91bmQgW2A8VmlydHVhbGl6ZWRMaXN0PmBdKGRvY3MvdmlydHVhbGl6ZWRsaXN0Lmh0bWwpLFxuICogYW5kIHRodXMgaW5oZXJpdHMgaXRzIHByb3BzIChhcyB3ZWxsIGFzIHRob3NlIG9mIGBTY3JvbGxWaWV3YCkgdGhhdCBhcmVuJ3QgZXhwbGljaXRseSBsaXN0ZWRcbiAqIGhlcmUsIGFsb25nIHdpdGggdGhlIGZvbGxvd2luZyBjYXZlYXRzOlxuICpcbiAqIC0gSW50ZXJuYWwgc3RhdGUgaXMgbm90IHByZXNlcnZlZCB3aGVuIGNvbnRlbnQgc2Nyb2xscyBvdXQgb2YgdGhlIHJlbmRlciB3aW5kb3cuIE1ha2Ugc3VyZSBhbGxcbiAqICAgeW91ciBkYXRhIGlzIGNhcHR1cmVkIGluIHRoZSBpdGVtIGRhdGEgb3IgZXh0ZXJuYWwgc3RvcmVzIGxpa2UgRmx1eCwgUmVkdXgsIG9yIFJlbGF5LlxuICogLSBUaGlzIGlzIGEgYFB1cmVDb21wb25lbnRgIHdoaWNoIG1lYW5zIHRoYXQgaXQgd2lsbCBub3QgcmUtcmVuZGVyIGlmIGBwcm9wc2AgcmVtYWluIHNoYWxsb3ctXG4gKiAgIGVxdWFsLiBNYWtlIHN1cmUgdGhhdCBldmVyeXRoaW5nIHlvdXIgYHJlbmRlckl0ZW1gIGZ1bmN0aW9uIGRlcGVuZHMgb24gaXMgcGFzc2VkIGFzIGEgcHJvcFxuICogICAoZS5nLiBgZXh0cmFEYXRhYCkgdGhhdCBpcyBub3QgYD09PWAgYWZ0ZXIgdXBkYXRlcywgb3RoZXJ3aXNlIHlvdXIgVUkgbWF5IG5vdCB1cGRhdGUgb25cbiAqICAgY2hhbmdlcy4gVGhpcyBpbmNsdWRlcyB0aGUgYGRhdGFgIHByb3AgYW5kIHBhcmVudCBjb21wb25lbnQgc3RhdGUuXG4gKiAtIEluIG9yZGVyIHRvIGNvbnN0cmFpbiBtZW1vcnkgYW5kIGVuYWJsZSBzbW9vdGggc2Nyb2xsaW5nLCBjb250ZW50IGlzIHJlbmRlcmVkIGFzeW5jaHJvbm91c2x5XG4gKiAgIG9mZnNjcmVlbi4gVGhpcyBtZWFucyBpdCdzIHBvc3NpYmxlIHRvIHNjcm9sbCBmYXN0ZXIgdGhhbiB0aGUgZmlsbCByYXRlIGFuZHMgbW9tZW50YXJpbHkgc2VlXG4gKiAgIGJsYW5rIGNvbnRlbnQuIFRoaXMgaXMgYSB0cmFkZW9mZiB0aGF0IGNhbiBiZSBhZGp1c3RlZCB0byBzdWl0IHRoZSBuZWVkcyBvZiBlYWNoIGFwcGxpY2F0aW9uLFxuICogICBhbmQgd2UgYXJlIHdvcmtpbmcgb24gaW1wcm92aW5nIGl0IGJlaGluZCB0aGUgc2NlbmVzLlxuICogLSBCeSBkZWZhdWx0LCB0aGUgbGlzdCBsb29rcyBmb3IgYSBga2V5YCBwcm9wIG9uIGVhY2ggaXRlbSBhbmQgdXNlcyB0aGF0IGZvciB0aGUgUmVhY3Qga2V5LlxuICogICBBbHRlcm5hdGl2ZWx5LCB5b3UgY2FuIHByb3ZpZGUgYSBjdXN0b20gYGtleUV4dHJhY3RvcmAgcHJvcC5cbiAqXG4gKiBBbHNvIGluaGVyaXRzIFtTY3JvbGxWaWV3IFByb3BzXShkb2NzL3Njcm9sbHZpZXcuaHRtbCNwcm9wcyksIHVubGVzcyBpdCBpcyBuZXN0ZWQgaW4gYW5vdGhlciBGbGF0TGlzdCBvZiBzYW1lIG9yaWVudGF0aW9uLlxuICovXG5jbGFzcyBGbGF0TGlzdDxJdGVtVD4gZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PFByb3BzPEl0ZW1UPiwgdm9pZD4ge1xuICBzdGF0aWMgZGVmYXVsdFByb3BzOiBEZWZhdWx0UHJvcHMgPSBkZWZhdWx0UHJvcHM7XG4gIHByb3BzOiBQcm9wczxJdGVtVD47XG4gIC8qKlxuICAgKiBTY3JvbGxzIHRvIHRoZSBlbmQgb2YgdGhlIGNvbnRlbnQuIE1heSBiZSBqYW5reSB3aXRob3V0IGBnZXRJdGVtTGF5b3V0YCBwcm9wLlxuICAgKi9cbiAgc2Nyb2xsVG9FbmQocGFyYW1zPzogP3thbmltYXRlZD86ID9ib29sZWFufSkge1xuICAgIGlmICh0aGlzLl9saXN0UmVmKSB7XG4gICAgICB0aGlzLl9saXN0UmVmLnNjcm9sbFRvRW5kKHBhcmFtcyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFNjcm9sbHMgdG8gdGhlIGl0ZW0gYXQgdGhlIHNwZWNpZmllZCBpbmRleCBzdWNoIHRoYXQgaXQgaXMgcG9zaXRpb25lZCBpbiB0aGUgdmlld2FibGUgYXJlYVxuICAgKiBzdWNoIHRoYXQgYHZpZXdQb3NpdGlvbmAgMCBwbGFjZXMgaXQgYXQgdGhlIHRvcCwgMSBhdCB0aGUgYm90dG9tLCBhbmQgMC41IGNlbnRlcmVkIGluIHRoZVxuICAgKiBtaWRkbGUuIGB2aWV3T2Zmc2V0YCBpcyBhIGZpeGVkIG51bWJlciBvZiBwaXhlbHMgdG8gb2Zmc2V0IHRoZSBmaW5hbCB0YXJnZXQgcG9zaXRpb24uXG4gICAqXG4gICAqIE5vdGU6IGNhbm5vdCBzY3JvbGwgdG8gbG9jYXRpb25zIG91dHNpZGUgdGhlIHJlbmRlciB3aW5kb3cgd2l0aG91dCBzcGVjaWZ5aW5nIHRoZVxuICAgKiBgZ2V0SXRlbUxheW91dGAgcHJvcC5cbiAgICovXG4gIHNjcm9sbFRvSW5kZXgocGFyYW1zOiB7XG4gICAgYW5pbWF0ZWQ/OiA/Ym9vbGVhbixcbiAgICBpbmRleDogbnVtYmVyLFxuICAgIHZpZXdPZmZzZXQ/OiBudW1iZXIsXG4gICAgdmlld1Bvc2l0aW9uPzogbnVtYmVyLFxuICB9KSB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIHRoaXMuX2xpc3RSZWYuc2Nyb2xsVG9JbmRleChwYXJhbXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXF1aXJlcyBsaW5lYXIgc2NhbiB0aHJvdWdoIGRhdGEgLSB1c2UgYHNjcm9sbFRvSW5kZXhgIGluc3RlYWQgaWYgcG9zc2libGUuXG4gICAqXG4gICAqIE5vdGU6IGNhbm5vdCBzY3JvbGwgdG8gbG9jYXRpb25zIG91dHNpZGUgdGhlIHJlbmRlciB3aW5kb3cgd2l0aG91dCBzcGVjaWZ5aW5nIHRoZVxuICAgKiBgZ2V0SXRlbUxheW91dGAgcHJvcC5cbiAgICovXG4gIHNjcm9sbFRvSXRlbShwYXJhbXM6IHtcbiAgICBhbmltYXRlZD86ID9ib29sZWFuLFxuICAgIGl0ZW06IEl0ZW1ULFxuICAgIHZpZXdQb3NpdGlvbj86IG51bWJlcixcbiAgfSkge1xuICAgIGlmICh0aGlzLl9saXN0UmVmKSB7XG4gICAgICB0aGlzLl9saXN0UmVmLnNjcm9sbFRvSXRlbShwYXJhbXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTY3JvbGwgdG8gYSBzcGVjaWZpYyBjb250ZW50IHBpeGVsIG9mZnNldCBpbiB0aGUgbGlzdC5cbiAgICpcbiAgICogQ2hlY2sgb3V0IFtzY3JvbGxUb09mZnNldF0oZG9jcy92aXJ0dWFsaXplZGxpc3QuaHRtbCNzY3JvbGx0b29mZnNldCkgb2YgVmlydHVhbGl6ZWRMaXN0XG4gICAqL1xuICBzY3JvbGxUb09mZnNldChwYXJhbXM6IHthbmltYXRlZD86ID9ib29sZWFuLCBvZmZzZXQ6IG51bWJlcn0pIHtcbiAgICBpZiAodGhpcy5fbGlzdFJlZikge1xuICAgICAgdGhpcy5fbGlzdFJlZi5zY3JvbGxUb09mZnNldChwYXJhbXMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUZWxscyB0aGUgbGlzdCBhbiBpbnRlcmFjdGlvbiBoYXMgb2NjdXJyZWQsIHdoaWNoIHNob3VsZCB0cmlnZ2VyIHZpZXdhYmlsaXR5IGNhbGN1bGF0aW9ucywgZS5nLlxuICAgKiBpZiBgd2FpdEZvckludGVyYWN0aW9uc2AgaXMgdHJ1ZSBhbmQgdGhlIHVzZXIgaGFzIG5vdCBzY3JvbGxlZC4gVGhpcyBpcyB0eXBpY2FsbHkgY2FsbGVkIGJ5XG4gICAqIHRhcHMgb24gaXRlbXMgb3IgYnkgbmF2aWdhdGlvbiBhY3Rpb25zLlxuICAgKi9cbiAgcmVjb3JkSW50ZXJhY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIHRoaXMuX2xpc3RSZWYucmVjb3JkSW50ZXJhY3Rpb24oKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGlzcGxheXMgdGhlIHNjcm9sbCBpbmRpY2F0b3JzIG1vbWVudGFyaWx5LlxuICAgKlxuICAgKiBAcGxhdGZvcm0gaW9zXG4gICAqL1xuICBmbGFzaFNjcm9sbEluZGljYXRvcnMoKSB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIHRoaXMuX2xpc3RSZWYuZmxhc2hTY3JvbGxJbmRpY2F0b3JzKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFByb3ZpZGVzIGEgaGFuZGxlIHRvIHRoZSB1bmRlcmx5aW5nIHNjcm9sbCByZXNwb25kZXIuXG4gICAqL1xuICBnZXRTY3JvbGxSZXNwb25kZXIoKSB7XG4gICAgaWYgKHRoaXMuX2xpc3RSZWYpIHtcbiAgICAgIHJldHVybiB0aGlzLl9saXN0UmVmLmdldFNjcm9sbFJlc3BvbmRlcigpO1xuICAgIH1cbiAgfVxuXG4gIGdldFNjcm9sbGFibGVOb2RlKCkge1xuICAgIGlmICh0aGlzLl9saXN0UmVmKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbGlzdFJlZi5nZXRTY3JvbGxhYmxlTm9kZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldE5hdGl2ZVByb3BzKHByb3BzOiB7W3N0cmluZ106IG1peGVkfSkge1xuICAgIGlmICh0aGlzLl9saXN0UmVmKSB7XG4gICAgICB0aGlzLl9saXN0UmVmLnNldE5hdGl2ZVByb3BzKHByb3BzKTtcbiAgICB9XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHM8SXRlbVQ+KSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuX2NoZWNrUHJvcHModGhpcy5wcm9wcyk7XG4gICAgaWYgKHRoaXMucHJvcHMudmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXJzKSB7XG4gICAgICB0aGlzLl92aXJ0dWFsaXplZExpc3RQYWlycyA9IHRoaXMucHJvcHMudmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXJzLm1hcChcbiAgICAgICAgcGFpciA9PiAoe1xuICAgICAgICAgIHZpZXdhYmlsaXR5Q29uZmlnOiBwYWlyLnZpZXdhYmlsaXR5Q29uZmlnLFxuICAgICAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQ6IHRoaXMuX2NyZWF0ZU9uVmlld2FibGVJdGVtc0NoYW5nZWQoXG4gICAgICAgICAgICBwYWlyLm9uVmlld2FibGVJdGVtc0NoYW5nZWQsXG4gICAgICAgICAgKSxcbiAgICAgICAgfSksXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5vblZpZXdhYmxlSXRlbXNDaGFuZ2VkKSB7XG4gICAgICAvKiAkRmxvd0ZpeE1lKD49MC42My4wIHNpdGU9cmVhY3RfbmF0aXZlX2ZiKSBUaGlzIGNvbW1lbnQgc3VwcHJlc3NlcyBhblxuICAgICAgICogZXJyb3IgZm91bmQgd2hlbiBGbG93IHYwLjYzIHdhcyBkZXBsb3llZC4gVG8gc2VlIHRoZSBlcnJvciBkZWxldGUgdGhpc1xuICAgICAgICogY29tbWVudCBhbmQgcnVuIEZsb3cuICovXG4gICAgICB0aGlzLl92aXJ0dWFsaXplZExpc3RQYWlycy5wdXNoKHtcbiAgICAgICAgdmlld2FiaWxpdHlDb25maWc6IHRoaXMucHJvcHMudmlld2FiaWxpdHlDb25maWcsXG4gICAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQ6IHRoaXMuX2NyZWF0ZU9uVmlld2FibGVJdGVtc0NoYW5nZWQoXG4gICAgICAgICAgdGhpcy5wcm9wcy5vblZpZXdhYmxlSXRlbXNDaGFuZ2VkLFxuICAgICAgICApLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wczogUHJvcHM8SXRlbVQ+KSB7XG4gICAgaW52YXJpYW50KFxuICAgICAgcHJldlByb3BzLm51bUNvbHVtbnMgPT09IHRoaXMucHJvcHMubnVtQ29sdW1ucyxcbiAgICAgICdDaGFuZ2luZyBudW1Db2x1bW5zIG9uIHRoZSBmbHkgaXMgbm90IHN1cHBvcnRlZC4gQ2hhbmdlIHRoZSBrZXkgcHJvcCBvbiBGbGF0TGlzdCB3aGVuICcgK1xuICAgICAgICAnY2hhbmdpbmcgdGhlIG51bWJlciBvZiBjb2x1bW5zIHRvIGZvcmNlIGEgZnJlc2ggcmVuZGVyIG9mIHRoZSBjb21wb25lbnQuJyxcbiAgICApO1xuICAgIGludmFyaWFudChcbiAgICAgIHByZXZQcm9wcy5vblZpZXdhYmxlSXRlbXNDaGFuZ2VkID09PSB0aGlzLnByb3BzLm9uVmlld2FibGVJdGVtc0NoYW5nZWQsXG4gICAgICAnQ2hhbmdpbmcgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCBvbiB0aGUgZmx5IGlzIG5vdCBzdXBwb3J0ZWQnLFxuICAgICk7XG4gICAgaW52YXJpYW50KFxuICAgICAgIWRlZXBEaWZmZXIocHJldlByb3BzLnZpZXdhYmlsaXR5Q29uZmlnLCB0aGlzLnByb3BzLnZpZXdhYmlsaXR5Q29uZmlnKSxcbiAgICAgICdDaGFuZ2luZyB2aWV3YWJpbGl0eUNvbmZpZyBvbiB0aGUgZmx5IGlzIG5vdCBzdXBwb3J0ZWQnLFxuICAgICk7XG4gICAgaW52YXJpYW50KFxuICAgICAgcHJldlByb3BzLnZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycyA9PT1cbiAgICAgICAgdGhpcy5wcm9wcy52aWV3YWJpbGl0eUNvbmZpZ0NhbGxiYWNrUGFpcnMsXG4gICAgICAnQ2hhbmdpbmcgdmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXJzIG9uIHRoZSBmbHkgaXMgbm90IHN1cHBvcnRlZCcsXG4gICAgKTtcblxuICAgIHRoaXMuX2NoZWNrUHJvcHModGhpcy5wcm9wcyk7XG4gIH1cblxuICBfbGlzdFJlZjogP1JlYWN0LkVsZW1lbnRSZWY8dHlwZW9mIFZpcnR1YWxpemVkTGlzdD47XG4gIF92aXJ0dWFsaXplZExpc3RQYWlyczogQXJyYXk8Vmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXI+ID0gW107XG5cbiAgX2NhcHR1cmVSZWYgPSByZWYgPT4ge1xuICAgIHRoaXMuX2xpc3RSZWYgPSByZWY7XG4gIH07XG5cbiAgX2NoZWNrUHJvcHMocHJvcHM6IFByb3BzPEl0ZW1UPikge1xuICAgIGNvbnN0IHtcbiAgICAgIGdldEl0ZW0sXG4gICAgICBnZXRJdGVtQ291bnQsXG4gICAgICBob3Jpem9udGFsLFxuICAgICAgbnVtQ29sdW1ucyxcbiAgICAgIGNvbHVtbldyYXBwZXJTdHlsZSxcbiAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQsXG4gICAgICB2aWV3YWJpbGl0eUNvbmZpZ0NhbGxiYWNrUGFpcnMsXG4gICAgfSA9IHByb3BzO1xuICAgIGludmFyaWFudChcbiAgICAgICFnZXRJdGVtICYmICFnZXRJdGVtQ291bnQsXG4gICAgICAnRmxhdExpc3QgZG9lcyBub3Qgc3VwcG9ydCBjdXN0b20gZGF0YSBmb3JtYXRzLicsXG4gICAgKTtcbiAgICBpZiAobnVtQ29sdW1ucyA+IDEpIHtcbiAgICAgIGludmFyaWFudCghaG9yaXpvbnRhbCwgJ251bUNvbHVtbnMgZG9lcyBub3Qgc3VwcG9ydCBob3Jpem9udGFsLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgICFjb2x1bW5XcmFwcGVyU3R5bGUsXG4gICAgICAgICdjb2x1bW5XcmFwcGVyU3R5bGUgbm90IHN1cHBvcnRlZCBmb3Igc2luZ2xlIGNvbHVtbiBsaXN0cycsXG4gICAgICApO1xuICAgIH1cbiAgICBpbnZhcmlhbnQoXG4gICAgICAhKG9uVmlld2FibGVJdGVtc0NoYW5nZWQgJiYgdmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXJzKSxcbiAgICAgICdGbGF0TGlzdCBkb2VzIG5vdCBzdXBwb3J0IHNldHRpbmcgYm90aCBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkIGFuZCAnICtcbiAgICAgICAgJ3ZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycy4nLFxuICAgICk7XG4gIH1cblxuICBfZ2V0SXRlbSA9IChkYXRhOiBBcnJheTxJdGVtVD4sIGluZGV4OiBudW1iZXIpID0+IHtcbiAgICBjb25zdCB7bnVtQ29sdW1uc30gPSB0aGlzLnByb3BzO1xuICAgIGlmIChudW1Db2x1bW5zID4gMSkge1xuICAgICAgY29uc3QgcmV0ID0gW107XG4gICAgICBmb3IgKGxldCBrayA9IDA7IGtrIDwgbnVtQ29sdW1uczsga2srKykge1xuICAgICAgICBjb25zdCBpdGVtID0gZGF0YVtpbmRleCAqIG51bUNvbHVtbnMgKyBra107XG4gICAgICAgIGlmIChpdGVtICE9IG51bGwpIHtcbiAgICAgICAgICByZXQucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGRhdGFbaW5kZXhdO1xuICAgIH1cbiAgfTtcblxuICBfZ2V0SXRlbUNvdW50ID0gKGRhdGE6ID9BcnJheTxJdGVtVD4pOiBudW1iZXIgPT4ge1xuICAgIHJldHVybiBkYXRhID8gTWF0aC5jZWlsKGRhdGEubGVuZ3RoIC8gdGhpcy5wcm9wcy5udW1Db2x1bW5zKSA6IDA7XG4gIH07XG5cbiAgX2tleUV4dHJhY3RvciA9IChpdGVtczogSXRlbVQgfCBBcnJheTxJdGVtVD4sIGluZGV4OiBudW1iZXIpID0+IHtcbiAgICBjb25zdCB7a2V5RXh0cmFjdG9yLCBudW1Db2x1bW5zfSA9IHRoaXMucHJvcHM7XG4gICAgaWYgKG51bUNvbHVtbnMgPiAxKSB7XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIEFycmF5LmlzQXJyYXkoaXRlbXMpLFxuICAgICAgICAnRmxhdExpc3Q6IEVuY291bnRlcmVkIGludGVybmFsIGNvbnNpc3RlbmN5IGVycm9yLCBleHBlY3RlZCBlYWNoIGl0ZW0gdG8gY29uc2lzdCBvZiBhbiAnICtcbiAgICAgICAgICAnYXJyYXkgd2l0aCAxLSVzIGNvbHVtbnM7IGluc3RlYWQsIHJlY2VpdmVkIGEgc2luZ2xlIGl0ZW0uJyxcbiAgICAgICAgbnVtQ29sdW1ucyxcbiAgICAgICk7XG4gICAgICByZXR1cm4gaXRlbXNcbiAgICAgICAgLm1hcCgoaXQsIGtrKSA9PiBrZXlFeHRyYWN0b3IoaXQsIGluZGV4ICogbnVtQ29sdW1ucyArIGtrKSlcbiAgICAgICAgLmpvaW4oJzonKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLyogJEZsb3dGaXhNZSg+PTAuNjMuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpcyBjb21tZW50IHN1cHByZXNzZXMgYW5cbiAgICAgICAqIGVycm9yIGZvdW5kIHdoZW4gRmxvdyB2MC42MyB3YXMgZGVwbG95ZWQuIFRvIHNlZSB0aGUgZXJyb3IgZGVsZXRlIHRoaXNcbiAgICAgICAqIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICAgICAgcmV0dXJuIGtleUV4dHJhY3RvcihpdGVtcywgaW5kZXgpO1xuICAgIH1cbiAgfTtcblxuICBfcHVzaE11bHRpQ29sdW1uVmlld2FibGUoYXJyOiBBcnJheTxWaWV3VG9rZW4+LCB2OiBWaWV3VG9rZW4pOiB2b2lkIHtcbiAgICBjb25zdCB7bnVtQ29sdW1ucywga2V5RXh0cmFjdG9yfSA9IHRoaXMucHJvcHM7XG4gICAgdi5pdGVtLmZvckVhY2goKGl0ZW0sIGlpKSA9PiB7XG4gICAgICBpbnZhcmlhbnQodi5pbmRleCAhPSBudWxsLCAnTWlzc2luZyBpbmRleCEnKTtcbiAgICAgIGNvbnN0IGluZGV4ID0gdi5pbmRleCAqIG51bUNvbHVtbnMgKyBpaTtcbiAgICAgIGFyci5wdXNoKHsuLi52LCBpdGVtLCBrZXk6IGtleUV4dHJhY3RvcihpdGVtLCBpbmRleCksIGluZGV4fSk7XG4gICAgfSk7XG4gIH1cblxuICBfY3JlYXRlT25WaWV3YWJsZUl0ZW1zQ2hhbmdlZChcbiAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkOiA/KGluZm86IHtcbiAgICAgIHZpZXdhYmxlSXRlbXM6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgICBjaGFuZ2VkOiBBcnJheTxWaWV3VG9rZW4+LFxuICAgIH0pID0+IHZvaWQsXG4gICkge1xuICAgIHJldHVybiAoaW5mbzoge1xuICAgICAgdmlld2FibGVJdGVtczogQXJyYXk8Vmlld1Rva2VuPixcbiAgICAgIGNoYW5nZWQ6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3Qge251bUNvbHVtbnN9ID0gdGhpcy5wcm9wcztcbiAgICAgIGlmIChvblZpZXdhYmxlSXRlbXNDaGFuZ2VkKSB7XG4gICAgICAgIGlmIChudW1Db2x1bW5zID4gMSkge1xuICAgICAgICAgIGNvbnN0IGNoYW5nZWQgPSBbXTtcbiAgICAgICAgICBjb25zdCB2aWV3YWJsZUl0ZW1zID0gW107XG4gICAgICAgICAgaW5mby52aWV3YWJsZUl0ZW1zLmZvckVhY2godiA9PlxuICAgICAgICAgICAgdGhpcy5fcHVzaE11bHRpQ29sdW1uVmlld2FibGUodmlld2FibGVJdGVtcywgdiksXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpbmZvLmNoYW5nZWQuZm9yRWFjaCh2ID0+IHRoaXMuX3B1c2hNdWx0aUNvbHVtblZpZXdhYmxlKGNoYW5nZWQsIHYpKTtcbiAgICAgICAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkKHt2aWV3YWJsZUl0ZW1zLCBjaGFuZ2VkfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZChpbmZvKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBfcmVuZGVySXRlbSA9IChpbmZvOiBPYmplY3QpID0+IHtcbiAgICBjb25zdCB7cmVuZGVySXRlbSwgbnVtQ29sdW1ucywgY29sdW1uV3JhcHBlclN0eWxlfSA9IHRoaXMucHJvcHM7XG4gICAgaWYgKG51bUNvbHVtbnMgPiAxKSB7XG4gICAgICBjb25zdCB7aXRlbSwgaW5kZXh9ID0gaW5mbztcbiAgICAgIGludmFyaWFudChcbiAgICAgICAgQXJyYXkuaXNBcnJheShpdGVtKSxcbiAgICAgICAgJ0V4cGVjdGVkIGFycmF5IG9mIGl0ZW1zIHdpdGggbnVtQ29sdW1ucyA+IDEnLFxuICAgICAgKTtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxWaWV3XG4gICAgICAgICAgc3R5bGU9e1N0eWxlU2hlZXQuY29tcG9zZShcbiAgICAgICAgICAgIHN0eWxlcy5yb3csXG4gICAgICAgICAgICBjb2x1bW5XcmFwcGVyU3R5bGUsXG4gICAgICAgICAgKX0+XG4gICAgICAgICAge2l0ZW0ubWFwKChpdCwga2spID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSByZW5kZXJJdGVtKHtcbiAgICAgICAgICAgICAgaXRlbTogaXQsXG4gICAgICAgICAgICAgIGluZGV4OiBpbmRleCAqIG51bUNvbHVtbnMgKyBrayxcbiAgICAgICAgICAgICAgc2VwYXJhdG9yczogaW5mby5zZXBhcmF0b3JzLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudCAmJiBSZWFjdC5jbG9uZUVsZW1lbnQoZWxlbWVudCwge2tleToga2t9KTtcbiAgICAgICAgICB9KX1cbiAgICAgICAgPC9WaWV3PlxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlbmRlckl0ZW0oaW5mbyk7XG4gICAgfVxuICB9O1xuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPFZpcnR1YWxpemVkTGlzdFxuICAgICAgICB7Li4udGhpcy5wcm9wc31cbiAgICAgICAgcmVuZGVySXRlbT17dGhpcy5fcmVuZGVySXRlbX1cbiAgICAgICAgZ2V0SXRlbT17dGhpcy5fZ2V0SXRlbX1cbiAgICAgICAgZ2V0SXRlbUNvdW50PXt0aGlzLl9nZXRJdGVtQ291bnR9XG4gICAgICAgIGtleUV4dHJhY3Rvcj17dGhpcy5fa2V5RXh0cmFjdG9yfVxuICAgICAgICByZWY9e3RoaXMuX2NhcHR1cmVSZWZ9XG4gICAgICAgIHZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlycz17dGhpcy5fdmlydHVhbGl6ZWRMaXN0UGFpcnN9XG4gICAgICAvPlxuICAgICk7XG4gIH1cbn1cblxuY29uc3Qgc3R5bGVzID0gU3R5bGVTaGVldC5jcmVhdGUoe1xuICByb3c6IHtmbGV4RGlyZWN0aW9uOiAncm93J30sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBGbGF0TGlzdDtcbiJdfQ==