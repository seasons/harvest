4807835a740dca2961c8e61f4288c2b7
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Bag = void 0;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _react = _interopRequireDefault(require("react"));

var _Container = require("../../Components/Container");

var _Typography = require("../../Components/Typography");

var _Components = require("./Components.tsx");

var _Components2 = require("../../Components");

var _reactNative = require("react-native");

var _StateProvider = require("../../helpers/StateProvider");

var _utils = require("../../utils");

var _svgs = require("../../../assets/svgs");

var _Navigation = require("../../Navigation");

var SECTION_HEIGHT = 200;

var Bag = function Bag() {
  var _useStateValue = (0, _StateProvider.useStateValue)(),
      _useStateValue2 = (0, _slicedToArray2.default)(_useStateValue, 2),
      bag = _useStateValue2[0].bag,
      dispatch = _useStateValue2[1];

  var bagItems = bag;

  if (!bag || !bag.items) {
    return null;
  }

  var bagIsEmpty = bag.items.length === 0;
  var remainingPieces = 3 - bag.items.length;

  var handleRemove = function handleRemove(id) {
    return id;
  };

  var handleBagPlusPress = function handleBagPlusPress() {
    return (0, _Navigation.goToBrowse)();
  };

  var emptyBagItem = function emptyBagItem(index) {
    return _react.default.createElement(_Components2.Box, {
      p: 2,
      style: {
        height: SECTION_HEIGHT
      }
    }, _react.default.createElement(_Components2.Flex, {
      style: {
        flex: 2
      },
      flexWrap: "nowrap",
      flexDirection: "column",
      justifyContent: "space-between"
    }, _react.default.createElement(_Components2.Box, null, _react.default.createElement(_Typography.Sans, {
      size: "3"
    }, index + 1, "."), _react.default.createElement(_Typography.Sans, {
      size: "2",
      color: "gray"
    }, "Add your item")), _react.default.createElement(_Components2.Flex, {
      style: {
        flex: 2
      },
      flexDirection: "row",
      justifyContent: "flex-end",
      alignItems: "center"
    }, _react.default.createElement(_reactNative.TouchableWithoutFeedback, {
      onPress: function onPress() {
        return handleBagPlusPress();
      }
    }, _react.default.createElement(_svgs.BagPlus, null)), _react.default.createElement(_Components2.Spacer, {
      mr: 3
    }))));
  };

  var bagItem = function bagItem(item, index) {
    var imageURL = item.images && item.images.length && item.images[0].url;
    return _react.default.createElement(_Components2.Box, {
      p: 2,
      key: item.id,
      style: {
        height: SECTION_HEIGHT
      }
    }, _react.default.createElement(_Components2.Flex, {
      flexDirection: "row",
      style: {
        flex: 1
      }
    }, _react.default.createElement(_Components2.Flex, {
      style: {
        flex: 2
      },
      flexWrap: "nowrap",
      flexDirection: "column",
      justifyContent: "space-between"
    }, _react.default.createElement(_Components2.Box, null, _react.default.createElement(_Typography.Sans, {
      size: "3"
    }, index + 1, "."), _react.default.createElement(_Typography.Sans, {
      size: "2"
    }, item.brand.name, "."), _react.default.createElement(_Typography.Sans, {
      size: "2",
      color: "gray"
    }, item.name, ".")), _react.default.createElement(_Components2.Box, null, _react.default.createElement(_reactNative.Text, null, _react.default.createElement(_Typography.Sans, {
      size: "2",
      color: "gray"
    }, "Size ", item.modelSize, " |"), "  ", _react.default.createElement(_reactNative.TouchableWithoutFeedback, {
      onPress: function onPress() {
        return dispatch({
          type: "removeItemFromBag",
          item: item
        });
      }
    }, _react.default.createElement(_Typography.Sans, {
      size: "2",
      color: "blue"
    }, "Remove"))))), _react.default.createElement(_Components2.Flex, {
      style: {
        flex: 2
      },
      flexDirection: "row",
      justifyContent: "flex-end",
      alignItems: "center"
    }, _react.default.createElement(_reactNative.Image, {
      style: {
        height: SECTION_HEIGHT,
        width: 160
      },
      resizeMode: "contain",
      source: {
        uri: imageURL
      }
    }))));
  };

  var _renderItem = function renderItem(_ref) {
    var item = _ref.item,
        index = _ref.index;
    return item.type === "item" ? bagItem(item, index) : emptyBagItem(index);
  };

  return _react.default.createElement(_Components2.Theme, null, _react.default.createElement(_Container.Container, null, _react.default.createElement(_Components2.Box, {
    style: {
      flex: 1
    }
  }, _react.default.createElement(_Components2.Spacer, {
    mb: 3
  }), bagIsEmpty ? _react.default.createElement(_Components2.Flex, {
    flex: 1,
    flexDirection: "column",
    justifyContent: "center",
    alignContent: "center"
  }, _react.default.createElement(_Components.EmptyState, {
    remainingPieces: remainingPieces
  })) : _react.default.createElement(_Components2.Box, null, _react.default.createElement(_Components2.Spacer, {
    mb: 3
  }), _react.default.createElement(_reactNative.FlatList, {
    data: bagItems,
    ListHeaderComponent: function ListHeaderComponent() {
      return _react.default.createElement(_Components2.Box, {
        p: 2
      }, _react.default.createElement(_Typography.Sans, {
        size: "3",
        color: "black"
      }, "My bag"), _react.default.createElement(_Typography.Sans, {
        size: "2",
        color: "gray"
      }, "You have ", remainingPieces, " pieces remaining"));
    },
    ItemSeparatorComponent: function ItemSeparatorComponent() {
      return _react.default.createElement(_Components2.Box, {
        px: 2
      }, _react.default.createElement(_Components2.Spacer, {
        mb: 2
      }), _react.default.createElement(_Components2.Separator, {
        color: (0, _utils.color)("lightGray")
      }), _react.default.createElement(_Components2.Spacer, {
        mb: 2
      }));
    },
    keyExtractor: function keyExtractor(_item, index) {
      return String(index);
    },
    renderItem: function renderItem(item) {
      return _renderItem(item);
    },
    ListFooterComponent: function ListFooterComponent() {
      return _react.default.createElement(_Components2.Spacer, {
        mb: 200
      });
    }
  })))));
};

exports.Bag = Bag;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJhZy50c3giXSwibmFtZXMiOlsiU0VDVElPTl9IRUlHSFQiLCJCYWciLCJiYWciLCJkaXNwYXRjaCIsImJhZ0l0ZW1zIiwiaXRlbXMiLCJiYWdJc0VtcHR5IiwibGVuZ3RoIiwicmVtYWluaW5nUGllY2VzIiwiaGFuZGxlUmVtb3ZlIiwiaWQiLCJoYW5kbGVCYWdQbHVzUHJlc3MiLCJlbXB0eUJhZ0l0ZW0iLCJpbmRleCIsImhlaWdodCIsImZsZXgiLCJiYWdJdGVtIiwiaXRlbSIsImltYWdlVVJMIiwiaW1hZ2VzIiwidXJsIiwiYnJhbmQiLCJuYW1lIiwibW9kZWxTaXplIiwidHlwZSIsIndpZHRoIiwidXJpIiwicmVuZGVySXRlbSIsIl9pdGVtIiwiU3RyaW5nIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFFQSxJQUFNQSxjQUFjLEdBQUcsR0FBdkI7O0FBRU8sSUFBTUMsR0FBRyxHQUFHLFNBQU5BLEdBQU0sR0FBTTtBQUFBLHVCQUNLLG1DQURMO0FBQUE7QUFBQSxNQUNkQyxHQURjLHNCQUNkQSxHQURjO0FBQUEsTUFDUEMsUUFETzs7QUFFdkIsTUFBTUMsUUFBUSxHQUFHRixHQUFqQjs7QUFhQSxNQUFJLENBQUNBLEdBQUQsSUFBUSxDQUFDQSxHQUFHLENBQUNHLEtBQWpCLEVBQXdCO0FBQ3RCLFdBQU8sSUFBUDtBQUNEOztBQUVELE1BQU1DLFVBQVUsR0FBR0osR0FBRyxDQUFDRyxLQUFKLENBQVVFLE1BQVYsS0FBcUIsQ0FBeEM7QUFDQSxNQUFNQyxlQUFlLEdBQUcsSUFBSU4sR0FBRyxDQUFDRyxLQUFKLENBQVVFLE1BQXRDOztBQUVBLE1BQU1FLFlBQVksR0FBRyxTQUFmQSxZQUFlLENBQUFDLEVBQUUsRUFBSTtBQUN6QixXQUFPQSxFQUFQO0FBQ0QsR0FGRDs7QUFJQSxNQUFNQyxrQkFBa0IsR0FBRyxTQUFyQkEsa0JBQXFCLEdBQU07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QUFNLENBQUNoQixLQUFELENBQXhCO0FBQUEsS0FuQmhCO0FBb0JFLElBQUEsVUFBVSxFQUFFLG9CQUFBSSxJQUFJO0FBQUEsYUFBSVUsV0FBVSxDQUFDVixJQUFELENBQWQ7QUFBQSxLQXBCbEI7QUFxQkUsSUFBQSxtQkFBbUIsRUFBRTtBQUFBLGFBQU0sNkJBQUMsbUJBQUQ7QUFBUSxRQUFBLEVBQUUsRUFBRTtBQUFaLFFBQU47QUFBQTtBQXJCdkIsSUFGRixDQVBKLENBREYsQ0FERixDQURGO0FBeUNELENBMUlNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIlxuaW1wb3J0IHsgQ29udGFpbmVyIH0gZnJvbSBcIkNvbXBvbmVudHMvQ29udGFpbmVyXCJcbmltcG9ydCB7IFNhbnMgfSBmcm9tIFwiQ29tcG9uZW50cy9UeXBvZ3JhcGh5XCJcbmltcG9ydCB7IEVtcHR5U3RhdGUgfSBmcm9tIFwiLi9Db21wb25lbnRzLnRzeFwiXG5pbXBvcnQgeyBUaGVtZSwgU3BhY2VyLCBGbGV4LCBCb3gsIFNlcGFyYXRvciB9IGZyb20gXCJBcHAvQ29tcG9uZW50c1wiXG5pbXBvcnQgeyBUZXh0LCBJbWFnZSwgRmxhdExpc3QgfSBmcm9tIFwicmVhY3QtbmF0aXZlXCJcbmltcG9ydCB7IHVzZVN0YXRlVmFsdWUgfSBmcm9tIFwiQXBwL2hlbHBlcnMvU3RhdGVQcm92aWRlclwiXG5pbXBvcnQgeyBUb3VjaGFibGVXaXRob3V0RmVlZGJhY2sgfSBmcm9tIFwicmVhY3QtbmF0aXZlXCJcbmltcG9ydCB7IGNvbG9yIH0gZnJvbSBcIkFwcC91dGlsc1wiXG5pbXBvcnQgeyBCYWdQbHVzIH0gZnJvbSBcIi4uLy4uLy4uL2Fzc2V0cy9zdmdzXCJcbmltcG9ydCB7IGdvVG9Ccm93c2UgfSBmcm9tIFwiQXBwL05hdmlnYXRpb25cIlxuXG5jb25zdCBTRUNUSU9OX0hFSUdIVCA9IDIwMFxuXG5leHBvcnQgY29uc3QgQmFnID0gKCkgPT4ge1xuICBjb25zdCBbeyBiYWcgfSwgZGlzcGF0Y2hdID0gdXNlU3RhdGVWYWx1ZSgpXG4gIGNvbnN0IGJhZ0l0ZW1zID0gYmFnXG4gIC8vIGNvbnN0IFtiYWdJdGVtcywgc2V0QmFnSXRlbXNdID0gdXNlU3RhdGUoW10pXG4gIC8vIHVzZUVmZmVjdCgoKSA9PiB7XG4gIC8vICAgY29uc3QgYmFnQXJyYXkgPSBiYWcuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgLy8gICAgIGJhZ0l0ZW1zLnB1c2goeyB0eXBlOiBcIml0ZW1cIiwgLi4uaXRlbSB9KVxuICAvLyAgIH0pXG4gIC8vICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZW1haW5pbmdQaWVjZXM7IGkrKykge1xuICAvLyAgICAgYmFnSXRlbXMucHVzaCh7IHR5cGU6IFwiZW1wdHlcIiB9KVxuICAvLyAgIH1cbiAgLy8gICBzZXRCYWdJdGVtcyhiYWdBcnJheSlcbiAgLy8gICBjb25zb2xlLmxvZyhcImJhZ2l0ZW1zPz8/P1wiLCBiYWdJdGVtcylcbiAgLy8gfSwgW2JhZ10pXG5cbiAgaWYgKCFiYWcgfHwgIWJhZy5pdGVtcykge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBjb25zdCBiYWdJc0VtcHR5ID0gYmFnLml0ZW1zLmxlbmd0aCA9PT0gMFxuICBjb25zdCByZW1haW5pbmdQaWVjZXMgPSAzIC0gYmFnLml0ZW1zLmxlbmd0aFxuXG4gIGNvbnN0IGhhbmRsZVJlbW92ZSA9IGlkID0+IHtcbiAgICByZXR1cm4gaWRcbiAgfVxuXG4gIGNvbnN0IGhhbmRsZUJhZ1BsdXNQcmVzcyA9ICgpID0+IHtcbiAgICByZXR1cm4gZ29Ub0Jyb3dzZSgpXG4gIH1cblxuICBjb25zdCBlbXB0eUJhZ0l0ZW0gPSBpbmRleCA9PiB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxCb3ggcD17Mn0gc3R5bGU9e3sgaGVpZ2h0OiBTRUNUSU9OX0hFSUdIVCB9fT5cbiAgICAgICAgPEZsZXggc3R5bGU9e3sgZmxleDogMiB9fSBmbGV4V3JhcD1cIm5vd3JhcFwiIGZsZXhEaXJlY3Rpb249XCJjb2x1bW5cIiBqdXN0aWZ5Q29udGVudD1cInNwYWNlLWJldHdlZW5cIj5cbiAgICAgICAgICA8Qm94PlxuICAgICAgICAgICAgPFNhbnMgc2l6ZT1cIjNcIj57aW5kZXggKyAxfS48L1NhbnM+XG4gICAgICAgICAgICA8U2FucyBzaXplPVwiMlwiIGNvbG9yPVwiZ3JheVwiPlxuICAgICAgICAgICAgICBBZGQgeW91ciBpdGVtXG4gICAgICAgICAgICA8L1NhbnM+XG4gICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPEZsZXggc3R5bGU9e3sgZmxleDogMiB9fSBmbGV4RGlyZWN0aW9uPVwicm93XCIganVzdGlmeUNvbnRlbnQ9XCJmbGV4LWVuZFwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIj5cbiAgICAgICAgICAgIDxUb3VjaGFibGVXaXRob3V0RmVlZGJhY2sgb25QcmVzcz17KCkgPT4gaGFuZGxlQmFnUGx1c1ByZXNzKCl9PlxuICAgICAgICAgICAgICA8QmFnUGx1cyAvPlxuICAgICAgICAgICAgPC9Ub3VjaGFibGVXaXRob3V0RmVlZGJhY2s+XG4gICAgICAgICAgICA8U3BhY2VyIG1yPXszfSAvPlxuICAgICAgICAgIDwvRmxleD5cbiAgICAgICAgPC9GbGV4PlxuICAgICAgPC9Cb3g+XG4gICAgKVxuICB9XG5cbiAgY29uc3QgYmFnSXRlbSA9IChpdGVtLCBpbmRleCkgPT4ge1xuICAgIGNvbnN0IGltYWdlVVJMID0gaXRlbS5pbWFnZXMgJiYgaXRlbS5pbWFnZXMubGVuZ3RoICYmIGl0ZW0uaW1hZ2VzWzBdLnVybFxuICAgIHJldHVybiAoXG4gICAgICA8Qm94IHA9ezJ9IGtleT17aXRlbS5pZH0gc3R5bGU9e3sgaGVpZ2h0OiBTRUNUSU9OX0hFSUdIVCB9fT5cbiAgICAgICAgPEZsZXggZmxleERpcmVjdGlvbj1cInJvd1wiIHN0eWxlPXt7IGZsZXg6IDEgfX0+XG4gICAgICAgICAgPEZsZXggc3R5bGU9e3sgZmxleDogMiB9fSBmbGV4V3JhcD1cIm5vd3JhcFwiIGZsZXhEaXJlY3Rpb249XCJjb2x1bW5cIiBqdXN0aWZ5Q29udGVudD1cInNwYWNlLWJldHdlZW5cIj5cbiAgICAgICAgICAgIDxCb3g+XG4gICAgICAgICAgICAgIDxTYW5zIHNpemU9XCIzXCI+e2luZGV4ICsgMX0uPC9TYW5zPlxuICAgICAgICAgICAgICA8U2FucyBzaXplPVwiMlwiPntpdGVtLmJyYW5kLm5hbWV9LjwvU2Fucz5cbiAgICAgICAgICAgICAgPFNhbnMgc2l6ZT1cIjJcIiBjb2xvcj1cImdyYXlcIj5cbiAgICAgICAgICAgICAgICB7aXRlbS5uYW1lfS5cbiAgICAgICAgICAgICAgPC9TYW5zPlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICA8Qm94PlxuICAgICAgICAgICAgICA8VGV4dD5cbiAgICAgICAgICAgICAgICA8U2FucyBzaXplPVwiMlwiIGNvbG9yPVwiZ3JheVwiPlxuICAgICAgICAgICAgICAgICAgU2l6ZSB7aXRlbS5tb2RlbFNpemV9IHxcbiAgICAgICAgICAgICAgICA8L1NhbnM+XG4gICAgICAgICAgICAgICAge1wiICBcIn1cbiAgICAgICAgICAgICAgICA8VG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrXG4gICAgICAgICAgICAgICAgICBvblByZXNzPXsoKSA9PlxuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJyZW1vdmVJdGVtRnJvbUJhZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0sXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgPFNhbnMgc2l6ZT1cIjJcIiBjb2xvcj1cImJsdWVcIj5cbiAgICAgICAgICAgICAgICAgICAgUmVtb3ZlXG4gICAgICAgICAgICAgICAgICA8L1NhbnM+XG4gICAgICAgICAgICAgICAgPC9Ub3VjaGFibGVXaXRob3V0RmVlZGJhY2s+XG4gICAgICAgICAgICAgIDwvVGV4dD5cbiAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgIDwvRmxleD5cbiAgICAgICAgICA8RmxleCBzdHlsZT17eyBmbGV4OiAyIH19IGZsZXhEaXJlY3Rpb249XCJyb3dcIiBqdXN0aWZ5Q29udGVudD1cImZsZXgtZW5kXCIgYWxpZ25JdGVtcz1cImNlbnRlclwiPlxuICAgICAgICAgICAgPEltYWdlIHN0eWxlPXt7IGhlaWdodDogU0VDVElPTl9IRUlHSFQsIHdpZHRoOiAxNjAgfX0gcmVzaXplTW9kZT1cImNvbnRhaW5cIiBzb3VyY2U9e3sgdXJpOiBpbWFnZVVSTCB9fSAvPlxuICAgICAgICAgIDwvRmxleD5cbiAgICAgICAgPC9GbGV4PlxuICAgICAgPC9Cb3g+XG4gICAgKVxuICB9XG5cbiAgY29uc3QgcmVuZGVySXRlbSA9ICh7IGl0ZW0sIGluZGV4IH0pID0+IHtcbiAgICByZXR1cm4gaXRlbS50eXBlID09PSBcIml0ZW1cIiA/IGJhZ0l0ZW0oaXRlbSwgaW5kZXgpIDogZW1wdHlCYWdJdGVtKGluZGV4KVxuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8VGhlbWU+XG4gICAgICA8Q29udGFpbmVyPlxuICAgICAgICA8Qm94IHN0eWxlPXt7IGZsZXg6IDEgfX0+XG4gICAgICAgICAgPFNwYWNlciBtYj17M30gLz5cbiAgICAgICAgICB7YmFnSXNFbXB0eSA/IChcbiAgICAgICAgICAgIDxGbGV4IGZsZXg9ezF9IGZsZXhEaXJlY3Rpb249XCJjb2x1bW5cIiBqdXN0aWZ5Q29udGVudD1cImNlbnRlclwiIGFsaWduQ29udGVudD1cImNlbnRlclwiPlxuICAgICAgICAgICAgICA8RW1wdHlTdGF0ZSByZW1haW5pbmdQaWVjZXM9e3JlbWFpbmluZ1BpZWNlc30gLz5cbiAgICAgICAgICAgIDwvRmxleD5cbiAgICAgICAgICApIDogKFxuICAgICAgICAgICAgPEJveD5cbiAgICAgICAgICAgICAgPFNwYWNlciBtYj17M30gLz5cbiAgICAgICAgICAgICAgPEZsYXRMaXN0XG4gICAgICAgICAgICAgICAgZGF0YT17YmFnSXRlbXN9XG4gICAgICAgICAgICAgICAgTGlzdEhlYWRlckNvbXBvbmVudD17KCkgPT4gKFxuICAgICAgICAgICAgICAgICAgPEJveCBwPXsyfT5cbiAgICAgICAgICAgICAgICAgICAgPFNhbnMgc2l6ZT1cIjNcIiBjb2xvcj1cImJsYWNrXCI+XG4gICAgICAgICAgICAgICAgICAgICAgTXkgYmFnXG4gICAgICAgICAgICAgICAgICAgIDwvU2Fucz5cbiAgICAgICAgICAgICAgICAgICAgPFNhbnMgc2l6ZT1cIjJcIiBjb2xvcj1cImdyYXlcIj5cbiAgICAgICAgICAgICAgICAgICAgICBZb3UgaGF2ZSB7cmVtYWluaW5nUGllY2VzfSBwaWVjZXMgcmVtYWluaW5nXG4gICAgICAgICAgICAgICAgICAgIDwvU2Fucz5cbiAgICAgICAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgSXRlbVNlcGFyYXRvckNvbXBvbmVudD17KCkgPT4gKFxuICAgICAgICAgICAgICAgICAgPEJveCBweD17Mn0+XG4gICAgICAgICAgICAgICAgICAgIDxTcGFjZXIgbWI9ezJ9IC8+XG4gICAgICAgICAgICAgICAgICAgIDxTZXBhcmF0b3IgY29sb3I9e2NvbG9yKFwibGlnaHRHcmF5XCIpfSAvPlxuICAgICAgICAgICAgICAgICAgICA8U3BhY2VyIG1iPXsyfSAvPlxuICAgICAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICBrZXlFeHRyYWN0b3I9eyhfaXRlbSwgaW5kZXgpID0+IFN0cmluZyhpbmRleCl9XG4gICAgICAgICAgICAgICAgcmVuZGVySXRlbT17aXRlbSA9PiByZW5kZXJJdGVtKGl0ZW0pfVxuICAgICAgICAgICAgICAgIExpc3RGb290ZXJDb21wb25lbnQ9eygpID0+IDxTcGFjZXIgbWI9ezIwMH0gLz59XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICApfVxuICAgICAgICA8L0JveD5cbiAgICAgIDwvQ29udGFpbmVyPlxuICAgIDwvVGhlbWU+XG4gIClcbn1cbiJdfQ==